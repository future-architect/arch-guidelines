import{_ as o,C as h,o as e,c as g,E as a,a4 as n,b as p,w as i,a as s,a5 as r,j as t}from"./chunks/framework.BIcz3et1.js";const k="/arch-guidelines/assets/abstract.drawio.DqDgH1vP.png",u="/arch-guidelines/assets/connect.drawio.BP9tCbr_.png",C=JSON.parse('{"title":"I/F設計ガイドライン","description":"","frontmatter":{"sidebarDepth":4,"title":"I/F設計ガイドライン","author":"フューチャー株式会社","head":[["meta",{"name":"keywords","content":"I/F,システムI/F,システム統合,システム間連携,データ連携"}]]},"headers":[],"relativePath":"documents/forIF/if_guidelines.md","filePath":"documents/forIF/if_guidelines.md"}'),c={name:"documents/forIF/if_guidelines.md"},y={class:"tip custom-block"};function b(f,l,A,B,x,m){const E=h("page-title"),d=h("Mermaid");return e(),g("div",null,[a(E),l[11]||(l[11]=n("",28)),(e(),p(r,null,{default:i(()=>[a(d,{id:"mermaid-452",class:"mermaid",graph:"%25%25%7Binit%3A%20%7B'sequence'%3A%20%7B'mirrorActors'%3A%20false%7D%7D%7D%25%25%0AsequenceDiagram%0A%20%20actor%20Scheduler%2FOperator%20as%20%E3%82%B9%E3%82%B1%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%A9%2F%E9%81%8B%E7%94%A8%E8%80%85%0A%20%20actor%20TargetSystemDB%20as%20%22%E3%82%BF%E3%83%BC%E3%82%B2%E3%83%83%E3%83%88%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%20DB%20(MV%E5%88%A9%E7%94%A8)%22%0A%20%20actor%20MasterDB%20as%20%22%E3%83%9E%E3%82%B9%E3%82%BFDB%20(PostgreSQL)%22%0A%20%20actor%20TargetApplication%20as%20%22%E3%82%BF%E3%83%BC%E3%82%B2%E3%83%83%E3%83%88%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%20%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%AD%E3%82%B8%E3%83%83%E3%82%AF%22%0A%0A%20%20Scheduler%2FOperator-%3E%3ETargetSystemDB%3A%20REFRESH%20MATERIALIZED%20VIEW%20local_master_cache_mv%3B%0A%20%20activate%20TargetSystemDB%0A%0A%20%20TargetSystemDB-%3E%3EMasterDB%3A%20Query%20Master%20Table%20via%20Foreign%20Table%20(postgres_fdw)%0A%20%20activate%20MasterDB%0A%0A%20%20MasterDB--%3E%3ETargetSystemDB%3A%20Return%20Master%20Data%0A%20%20deactivate%20MasterDB%0A%0A%20%20TargetSystemDB-%3E%3ETargetSystemDB%3A%20Update%20local%20Materialized%20View%20(local_master_cache_mv)%0A%20%20deactivate%20TargetSystemDB%0A%0A%20%20TargetApplication-%3E%3ETargetSystemDB%3A%20SELECT%20*%20FROM%20local_master_cache_mv%3B%0A%20%20activate%20TargetSystemDB%0A%0A%20%20TargetSystemDB--%3E%3ETargetApplication%3A%20Return%20cached%20data%20from%20Materialized%20View%0A%20%20deactivate%20TargetSystemDB%0A"})]),fallback:i(()=>[...l[0]||(l[0]=[s(" Loading... ",-1)])]),_:1})),l[12]||(l[12]=n("",11)),(e(),p(r,null,{default:i(()=>[a(d,{id:"mermaid-528",class:"mermaid",graph:"%25%25%7Binit%3A%20%7B'sequence'%3A%20%7B'mirrorActors'%3A%20false%7D%7D%7D%25%25%0AsequenceDiagram%0A%20%20participant%20Sender%20as%20%E9%80%81%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%0A%20%20participant%20IFTbl%20as%20%E5%8F%97%E4%BF%A1%E5%81%B4%20I%2FF%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%0A%20%20participant%20ReceiverAPI%20as%20%E5%8F%97%E4%BF%A1%E5%81%B4%20Web%20API%0A%20%20participant%20ReceiverDB%20as%20%E5%8F%97%E4%BF%A1%E5%81%B4%20%E6%9C%AC%E7%95%AA%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%0A%0A%20%20Sender-%3E%3EIFTbl%3A%20INSERT%20%2F%20COPY%0A%0A%20%20Sender-%3E%3EReceiverAPI%3A%20POST%20%2Fapi%2Fnotify_import%3Cbr%2F%3E%7BbatchId%3A%20%22123%22%7D%0A%20%20activate%20ReceiverAPI%0A%0A%20%20ReceiverAPI-%3E%3EIFTbl%3A%20SELECT%20(%E3%83%90%E3%83%AA%E3%83%87%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%82%E5%AE%9F%E6%96%BD)%0A%20%20ReceiverAPI-%3E%3EReceiverDB%3A%20INSERT%20%2F%20UPDATE%0A%20%20ReceiverAPI--%3E%3ESender%3A%20200%20OK%20(%E5%AE%8C%E4%BA%86%E3%81%BE%E3%81%9F%E3%81%AF%E5%8F%97%E4%BB%98)%0A%20%20deactivate%20ReceiverAPI%0A"})]),fallback:i(()=>[...l[1]||(l[1]=[s(" Loading... ",-1)])]),_:1})),l[13]||(l[13]=n("",10)),(e(),p(r,null,{default:i(()=>[a(d,{id:"mermaid-652",class:"mermaid",graph:"%25%25%7Binit%3A%20%7B'sequence'%3A%20%7B'mirrorActors'%3A%20false%7D%7D%7D%25%25%0AsequenceDiagram%0A%20%20%20%20actor%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%0A%20%20%20%20participant%20US%20as%20%E4%B8%8A%E6%B5%81%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%0A%20%20%20%20participant%20DS%20as%20%E4%B8%8B%E6%B5%81%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%0A%0A%20%20%20%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC-%3E%3E%2BUS%3A%20%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E6%93%8D%E4%BD%9C%20(%E4%BE%8B%3A%20%E9%A1%A7%E5%AE%A2%E6%83%85%E5%A0%B1%E3%81%AE%E7%99%BB%E9%8C%B2%E3%83%BB%E6%9B%B4%E6%96%B0)%0A%20%20%20%20US--%3E%3E-%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%3A%20%E6%93%8D%E4%BD%9C%E5%AE%8C%E4%BA%86%E5%BF%9C%E7%AD%94%0A%0A%20%20%20%20activate%20US%0A%20%20%20%20US-%3E%3EUS%3A%20%E7%99%BB%E9%8C%B2%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%82%92%E5%85%83%E3%81%AB%E8%B5%B7%E5%8B%95%EF%BC%88%E3%81%BE%E3%81%9F%E3%81%AF%E3%83%9D%E3%83%BC%E3%83%AA%E3%83%B3%E3%82%B0%EF%BC%89%0A%20%20%20%20Note%20over%20US%3A%20%E9%80%A3%E6%90%BA%E5%AF%BE%E8%B1%A1%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%20(%E4%BE%8B%3A%20%E5%89%8D%E5%9B%9E%E9%80%A3%E6%90%BA%E4%BB%A5%E9%99%8D%E3%81%AE%E5%B7%AE%E5%88%86%E3%83%87%E3%83%BC%E3%82%BF)%20%E3%82%92%3Cbr%2F%3E%E8%87%AA%E8%BA%AB%E3%81%AEDB%E7%AD%89%E3%81%8B%E3%82%89%E6%8A%BD%E5%87%BA%E3%83%BB%E6%BA%96%E5%82%99%E3%81%99%E3%82%8B%E3%80%82%0A%20%20%20%20US-)%2BDS%3A%20%E3%80%90%E9%9D%9E%E5%90%8C%E6%9C%9F%E3%80%91%E3%83%87%E3%83%BC%E3%82%BF%E9%80%A3%E6%90%BA%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%20(Web%20API%20Push)%3Cbr%2F%3E%E4%BE%8B%3A%20POST%20%2Fapi%2Fcustomers%20%7B%E9%A1%A7%E5%AE%A2%E3%83%87%E3%83%BC%E3%82%BF%E9%85%8D%E5%88%97%7D%0A%20%20%20%20DS--)-US%3A%20%E5%BF%9C%E7%AD%94%0A"})]),fallback:i(()=>[...l[2]||(l[2]=[s(" Loading... ",-1)])]),_:1})),l[14]||(l[14]=n("",9)),(e(),p(r,null,{default:i(()=>[a(d,{id:"mermaid-771",class:"mermaid",graph:"%25%25%7Binit%3A%20%7B'sequence'%3A%20%7B'mirrorActors'%3A%20false%7D%7D%7D%25%25%0AsequenceDiagram%0A%20%20%20%20participant%20US%20as%20%E4%B8%8A%E6%B5%81%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%0A%20%20%20%20participant%20DS%20as%20%E4%B8%8B%E6%B5%81%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%0A%0A%20%20%20%20DS%20-%3E%3E%20DS%3A%20%E3%82%B9%E3%82%B1%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E8%B5%B7%E5%8B%95%0A%0A%20%20%20%20loop%20%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8C%E5%8F%96%E5%BE%97%E3%81%A7%E3%81%8D%E3%82%8B%E9%99%90%E3%82%8A%20(%E3%83%9A%E3%83%BC%E3%82%B8%E3%83%8D%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E5%87%A6%E7%90%86)%0A%20%20%20%20%20%20%20%20Note%20over%20DS%3A%20%E6%AC%A1%E3%81%AB%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B%E3%83%87%E3%83%BC%E3%82%BF%E7%AF%84%E5%9B%B2%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%A6%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%0A%20%20%20%20%20%20%20%20DS-%3E%3E%2BUS%3A%20%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%20(Web%20API%20%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97)%3Cbr%2F%3E%E4%BE%8B%3A%20GET%20%2Fapi%2Fv1%2Fproducts%3FpageToken%3DXXX%26limit%3D100%0A%20%20%20%20%20%20%20%20activate%20US%0A%20%20%20%20%20%20%20%20US--%3E%3E-DS%3A%20%E3%83%87%E3%83%BC%E3%82%BF%E5%BF%9C%E7%AD%94%3Cbr%2F%3E%E4%BE%8B%3A%20200%20OK%3Cbr%2F%3E%E3%83%AC%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B9%E3%83%9C%E3%83%87%E3%82%A3%3A%20%7B%E5%95%86%E5%93%81%E3%83%87%E3%83%BC%E3%82%BF%E9%85%8D%E5%88%97%2C%20nextPageToken%7D%0A%20%20%20%20%20%20%20%20deactivate%20US%0A%0A%20%20%20%20%20%20%20%20Note%20over%20DS%3A%20%E3%83%AC%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B9%E4%B8%AD%E3%81%AE%20nextPageToken%20%E7%AD%89%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%97%E3%80%81%3Cbr%2F%3E%E6%AC%A1%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8C%E5%AD%98%E5%9C%A8%E3%81%99%E3%82%8B%E3%81%8B%E5%88%A4%E6%96%AD%E3%80%82%3Cbr%2F%3E%E5%AD%98%E5%9C%A8%E3%81%99%E3%82%8C%E3%81%B0%E3%83%AB%E3%83%BC%E3%83%97%E7%B6%99%E7%B6%9A%E3%80%81%E3%81%AA%E3%81%91%E3%82%8C%E3%81%B0%E7%B5%82%E4%BA%86%E3%80%82%0A%20%20%20%20end%0A%0A%20%20%20%20DS%20-%3E%3E%20DS%3A%20%E5%8F%96%E5%BE%97%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92DB%E3%81%AA%E3%81%A9%E3%81%AB%E6%B0%B8%E7%B6%9A%E5%8C%96%0A"})]),fallback:i(()=>[...l[3]||(l[3]=[s(" Loading... ",-1)])]),_:1})),l[15]||(l[15]=n("",50)),l[16]||(l[16]=t("table",{tabindex:"0"},[t("thead",null,[t("tr",null,[t("th",{style:{"text-align":"left"}},"#"),t("th",{style:{"text-align":"left"}},"（1）個別バケット方式"),t("th",{style:{"text-align":"left"}},"（2）共有バケット方式")])]),t("tbody",null,[t("tr",null,[t("td",{style:{"text-align":"left"}},"説明"),t("td",{style:{"text-align":"left"}},"連携先ごとにバケットを分離する方式"),t("td",{style:{"text-align":"left"}},"複数の集信先が同じバケットを用いて共有する方式。全ての連携先で同一のセキュリティ・運用ポリシーが適用できる場合に向いている")]),t("tr",null,[t("td",{style:{"text-align":"left"}},"バケット名"),t("td",{style:{"text-align":"left"},dest:""},"{env}-{systen_name}-{outbound}-"),t("td",{style:{"text-align":"left"},outbound:""},"{env}-{systen_name}-")]),t("tr",null,[t("td",{style:{"text-align":"left"}},"例"),t("td",{style:{"text-align":"left"}},[t("code",null,"stg-fuga-outbound-partner-a")]),t("td",{style:{"text-align":"left"}},[t("code",null,"stg-fuga-outbound")])]),t("tr",null,[t("td",{style:{"text-align":"left"}},"ファイル再利用性"),t("td",{style:{"text-align":"left"}},"⚠️配信ファイルを異なる連携先間で共有したい場合、単純には実現できない"),t("td",{style:{"text-align":"left"}},"✅️ある配信ファイルを複数の連携先が参照することが容易")]),t("tr",null,[t("td",{style:{"text-align":"left"}},"利便性"),t("td",{style:{"text-align":"left"}},"❌️連携先が増えるごとにバケット作成・ポリシー設定の手間"),t("td",{style:{"text-align":"left"}},"✅️バケット共有できる")]),t("tr",null,[t("td",{style:{"text-align":"left"}},"柔軟性"),t("td",{style:{"text-align":"left"}},"✅️連携先ごとに異なる要件（暗号化、ライフサイクル、ストレージクラス等）を設定可"),t("td",{style:{"text-align":"left"}},"⚠️バケット全体で設定を共有するため、個別対応が難しい")]),t("tr",null,[t("td",{style:{"text-align":"left"}},"コスト監視"),t("td",{style:{"text-align":"left"}},"✅️連携先ごとの利用状況やコストの追跡が容易"),t("td",{style:{"text-align":"left"}},"⚠️将来的なコスト分析が必要になる場合、按分ロジックが必要となる")]),t("tr",null,[t("td",{style:{"text-align":"left"}},"上限制約"),t("td",{style:{"text-align":"left"}},"✅️発生しにくい"),t("td",{style:{"text-align":"left"}},"❌️AWSの場合、S3のバケットポリシーの上限が20KB")]),t("tr",null,[t("td",{style:{"text-align":"left"}},"セキュリティ"),t("td",{style:{"text-align":"left"}},"✅️ バケット単位でアクセス権を完全に分離可能で、情報漏洩時の影響範囲を最小化"),t("td",{style:{"text-align":"left"}},"⚠️フォルダ単位の複雑な権限設定が必要、設定ミスによる意図しないアクセス設定の懸念")]),t("tr",null,[t("td",{style:{"text-align":"left"}},"障害の影響範囲"),t("td",{style:{"text-align":"left"}},"✅️限定的（設定ミスが発生しても、影響範囲は該当のバケットのみ）"),t("td",{style:{"text-align":"left"}},"⚠️全体に波及")])])],-1)),l[17]||(l[17]=n("",146)),(e(),p(r,null,{default:i(()=>[a(d,{id:"mermaid-4729",class:"mermaid",graph:"%25%25%7Binit%3A%20%7B'sequence'%3A%20%7B'mirrorActors'%3A%20false%7D%7D%7D%25%25%0AsequenceDiagram%0A%20%20%20%20participant%20%E9%80%81%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%0A%20%20%20%20participant%20%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8%0A%20%20%20%20participant%20%E5%8F%97%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%0A%0A%20%20%20%20%E9%80%81%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0-%3E%3E%E9%80%81%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%3A%20%E3%83%90%E3%83%83%E3%83%81%E5%87%A6%E7%90%86%E9%96%8B%E5%A7%8B%20(%E5%86%85%E9%83%A8%E3%82%B9%E3%82%B1%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB)%0A%20%20%20%20activate%20%E9%80%81%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%0A%20%20%20%20%E9%80%81%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0-%3E%3E%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8%3A%20%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%20(Push)%0A%20%20%20%20activate%20%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8%0A%20%20%20%20%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8--%3E%3E%E9%80%81%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%3A%20%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%E5%AE%8C%E4%BA%86%0A%20%20%20%20deactivate%20%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8%0A%20%20%20%20deactivate%20%E9%80%81%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%0A%0A%20%20%20%20activate%20%E5%8F%97%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%0A%20%20%20%20%E5%8F%97%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0-%3E%3E%E5%8F%97%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%3A%20%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97%E5%87%A6%E7%90%86%E9%96%8B%E5%A7%8B%20(%E5%86%85%E9%83%A8%E3%82%B9%E3%82%B1%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB)%0A%20%20%20%20%E5%8F%97%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0-%3E%3E%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8%3A%20%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%20(Pull)%0A%20%20%20%20activate%20%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8%0A%20%20%20%20%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8--%3E%3E%E5%8F%97%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%3A%20%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97%0A%20%20%20%20deactivate%20%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8%0A%20%20%20%20%E5%8F%97%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0-%3E%3E%E5%8F%97%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%3A%20%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%97%E4%BF%A1%E5%87%A6%E7%90%86%0A%20%20%20%20deactivate%20%E5%8F%97%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%0A"})]),fallback:i(()=>[...l[4]||(l[4]=[s(" Loading... ",-1)])]),_:1})),l[18]||(l[18]=n("",61)),t("div",y,[l[6]||(l[6]=t("p",{class:"custom-block-title"},"集信ワークテーブルの活用",-1)),l[7]||(l[7]=t("p",null,"I/Fファイルをそのままのレイアウトで格納するテーブルを、集信ワークテーブルと明示的に呼び分けることがある。例えば、商品マスタを他システムから集信する場合は、「商品マスタ集信ワーク」を作る。テーブル定義はシステム共通項目など管理用のカラムを追加する以外は、ファイルの項目定義に合わせた型・桁にする。これをスキーマレベルの検証を通過したファイルは集信ワークにコミットする。その後、別ジョブでビジネスロジックを検証し、適切なデータ変換をしたうえで商品マスタへ登録するフローにする。これにより、保守性の高いシステムが実現できる。",-1)),(e(),p(r,null,{default:i(()=>[a(d,{id:"mermaid-5768",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20A%5B%E9%80%81%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%5D%20--%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%20--%3E%20B%5B(%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%B9%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B8)%5D%3B%0A%0A%20%20%20%20CDE%5B%E5%8F%97%E4%BF%A1%E5%81%B4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%3Cbr%2F%3E%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%9E%E6%A4%9C%E8%A8%BC%E3%83%BB%E5%8F%97%E4%BF%A1%E3%83%AF%E3%83%BC%E3%82%AF%E3%81%B8%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%5D%20--%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E5%87%A6%E7%90%86%20--%3E%20B%3B%0A%20%20%20%20CDE%20--%20%E3%83%AD%E3%83%BC%E3%83%89%E5%AE%8C%E4%BA%86%20--%3E%20F%5B(%E5%8F%97%E4%BF%A1%E3%83%AF%E3%83%BC%E3%82%AF%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB)%5D%3B%0A%0A%20%20%20%20GH%5B%E5%BE%8C%E7%B6%9A%E3%82%B8%E3%83%A7%E3%83%96%3Cbr%2F%3E%E6%95%B4%E5%90%88%E6%80%A7%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%E3%83%BB%E5%AE%9F%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E6%9B%B8%E8%BE%BC%5D%20--%20%E3%83%87%E3%83%BC%E3%82%BF%E8%AA%AD%E3%81%BF%E5%87%BA%E3%81%97%20--%3E%20F%3B%0A%20%20%20%20GH%20--%20%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF%20--%3E%20I%5B(%E5%AE%9F%E9%9A%9B%E3%81%AE%E3%83%9E%E3%82%B9%E3%82%BF%2F%E3%83%88%E3%83%A9%E3%83%B3%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB)%5D%3B%0A"})]),fallback:i(()=>[...l[5]||(l[5]=[s(" Loading... ",-1)])]),_:1})),l[8]||(l[8]=t("p",null,"なお、ワークテーブルのカラムのデータ型は、ファイルの項目定義に合わせても良いが、一旦すべて可変長の文字列型（TEXT等）で受け入れ（型違反でも取り込みが可能となる）、後続のジョブで型変換と検証を同時に行うという設計も、有用でありよく採用される。システム運用者の実施作業をDBに寄せることで、手順の効率化や運用負担を減らすことができる。集信ワークを可変長文字列型にする場合は、スキーマレベルの検証を実施後、ビジネスロジックレベルの検証を同一トランザクション内で実施することになる。",-1)),l[9]||(l[9]=t("p",null,[s("テーブルプレフィックスの識別子については "),t("a",{href:"https://future-architect.github.io/arch-guidelines/documents/forDB/postgresql_guidelines.html#%E3%83%86%E3%83%BC%E3%83%95%E3%82%99%E3%83%AB%E7%A8%AE%E5%88%A5%E3%81%AE%E8%AD%98%E5%88%A5%E5%AD%90",target:"_blank",rel:"noreferrer"},"PostgreSQL設計ガイドライン > テーブル種別の識別子"),s(" にも記載がある。")],-1))]),l[19]||(l[19]=t("h3",{id:"データ整合性",tabindex:"-1"},[s("データ整合性 "),t("a",{class:"header-anchor",href:"#データ整合性","aria-label":'Permalink to "データ整合性"'},"​")],-1)),l[20]||(l[20]=t("h4",{id:"配信ファイル間のデータ整合性",tabindex:"-1"},[s("配信ファイル間のデータ整合性 "),t("a",{class:"header-anchor",href:"#配信ファイル間のデータ整合性","aria-label":'Permalink to "配信ファイル間のデータ整合性"'},"​")],-1)),l[21]||(l[21]=t("p",null,"複数のテーブルのそれぞれで配信ファイルを作成する際、条件によっては配信ファイル間の整合性が崩れる場合がある。例えば、注文ヘッダー・明細のように親子関係があるテーブルで、ヘッダーテーブルの配信ファイル作成と、明細テーブルの配信ファイル作成の途中に、別のプロセスによる更新処理が入ると、DB側のトランザクション分離レベルの設定（READ COMMITEDなど）などによっては、ヘッダーファイルと明細ファイルで件数や合計金額の不一致が生じうる。",-1)),l[22]||(l[22]=t("p",null,"【不整合の例】",-1)),(e(),p(r,null,{default:i(()=>[a(d,{id:"mermaid-5788",class:"mermaid",graph:"%25%25%7Binit%3A%20%7B'sequence'%3A%20%7B'mirrorActors'%3A%20false%7D%7D%7D%25%25%0AsequenceDiagram%0A%20%20%20%20participant%20PA%20as%20%E9%80%81%E4%BF%A1%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E4%BD%9C%E6%88%90%E5%87%A6%E7%90%86%0A%20%20%20%20participant%20DB%20as%20DB%0A%20%20%20%20participant%20PB%20as%20%E3%82%AA%E3%83%B3%E3%83%A9%E3%82%A4%E3%83%B3%E7%94%BB%E9%9D%A2%0A%20%20%20%20participant%20HF%20as%20%E3%83%98%E3%83%83%E3%83%80%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%0A%20%20%20%20participant%20DF%20as%20%E6%98%8E%E7%B4%B0%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%0A%0A%20%20%20%20PA-%3E%3EDB%3A%20%E3%83%88%E3%83%A9%E3%83%B3%E3%82%B6%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E9%96%8B%E5%A7%8B%20(%E5%88%86%E9%9B%A2%E3%83%AC%E3%83%99%E3%83%AB%3A%20READ%20COMMITTED)%0A%20%20%20%20PA-%3E%3EDB%3A%20SELECT%20*%20FROM%20%E6%B3%A8%E6%96%87%E3%83%98%E3%83%83%E3%83%80%20WHERE%20%E6%B3%A8%E6%96%87ID%3D'X001'%3B%0A%20%20%20%20DB--%3E%3EPA%3A%20%E6%B3%A8%E6%96%87%E3%83%98%E3%83%83%E3%83%80%E6%83%85%E5%A0%B1%20(%E4%BE%8B%3A%20%E6%B3%A8%E6%96%87ID%3D'X001'%2C%20%E5%90%88%E8%A8%88%E9%87%91%E9%A1%8D%3D5000%2C%20%E6%98%8E%E7%B4%B0%E6%9C%9F%E5%BE%85%E6%95%B0%3D2)%0A%20%20%20%20PA-%3E%3EHF%3A%20%E3%83%98%E3%83%83%E3%83%80%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E4%BD%9C%E6%88%90%0A%20%20%20%20note%20over%20HF%3A%20%E3%83%98%E3%83%83%E3%83%80%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E3%81%AF%3Cbr%2F%3E%E6%9C%80%E5%88%9D%E3%81%AESELECT%E7%B5%90%E6%9E%9C%E3%81%8C%E4%BF%9D%E5%AD%98%0A%0A%20%20%20%20PB-%3E%3EDB%3A%20%E3%83%88%E3%83%A9%E3%83%B3%E3%82%B6%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E9%96%8B%E5%A7%8B%0A%20%20%20%20PB-%3E%3EDB%3A%20UPDATE%20%E6%B3%A8%E6%96%87%E3%83%98%E3%83%83%E3%83%80%20SET%20%E5%90%88%E8%A8%88%E9%87%91%E9%A1%8D%3D7000%2C%20%E6%98%8E%E7%B4%B0%E6%9C%9F%E5%BE%85%E6%95%B0%3D3%20WHERE%20%E6%B3%A8%E6%96%87ID%3D'X001'%3B%0A%20%20%20%20PB-%3E%3EDB%3A%20INSERT%20INTO%20%E6%B3%A8%E6%96%87%E6%98%8E%E7%B4%B0%20(%E6%B3%A8%E6%96%87ID%2C%20%E6%98%8E%E7%B4%B0%E7%95%AA%E5%8F%B7%2C%20%E5%95%86%E5%93%81%2C%20%E9%87%91%E9%A1%8D)%20VALUES%20('X001'%2C%203%2C%20'%E5%95%86%E5%93%81C'%2C%202000)%3B%0A%20%20%20%20PB-%3E%3EDB%3A%20%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%0A%0A%0A%20%20%20%20PA-%3E%3EDB%3A%20SELECT%20*%20FROM%20%E6%B3%A8%E6%96%87%E6%98%8E%E7%B4%B0%20WHERE%20%E6%B3%A8%E6%96%87ID%3D'X001'%3B%0A%20%20%20%20DB--%3E%3EPA%3A%20%E6%B3%A8%E6%96%87%E6%98%8E%E7%B4%B0%E6%83%85%E5%A0%B1%20(3%E4%BB%B6%E3%81%AE%E6%98%8E%E7%B4%B0%E3%83%87%E3%83%BC%E3%82%BF)%0A%20%20%20%20note%20over%20PA%3A%20READ%20COMMITTED%E3%81%AE%E3%81%9F%E3%82%81%E3%80%81%3Cbr%2F%3E%E3%82%AA%E3%83%B3%E3%83%A9%E3%82%A4%E3%83%B3%E7%94%BB%E9%9D%A2%E3%81%8C%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E3%81%97%E3%81%9F%3Cbr%2F%3E%E5%A4%89%E6%9B%B4%E5%BE%8C%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E8%AA%AD%E3%81%BF%E5%8F%96%E3%82%8B%0A%20%20%20%20PA-%3E%3EDF%3A%20%E6%98%8E%E7%B4%B0%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E4%BD%9C%E6%88%90%20(3%E4%BB%B6%E3%81%AE%E6%98%8E%E7%B4%B0%E3%83%87%E3%83%BC%E3%82%BF)%0A%20%20%20%20note%20over%20DF%3A%20%E6%98%8E%E7%B4%B0%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E3%81%AF%3Cbr%2F%3E2%E5%9B%9E%E7%9B%AE%E3%81%AESELECT%E7%B5%90%E6%9E%9C%E3%81%8C%E4%BF%9D%E5%AD%98%0A%0A%20%20%20%20PA-%3E%3EDB%3A%20%E3%83%88%E3%83%A9%E3%83%B3%E3%82%B6%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E7%B5%82%E4%BA%86%0A"})]),fallback:i(()=>[...l[10]||(l[10]=[s(" Loading... ",-1)])]),_:1})),l[23]||(l[23]=n("",125))])}const D=o(c,[["render",b]]);export{C as __pageData,D as default};
