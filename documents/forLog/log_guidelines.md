---
sidebarDepth: 4
title: ãƒ­ã‚°è¨­è¨ˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
author: ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼æ ªå¼ä¼šç¤¾
head:
  - - meta
    - name: keywords
      content: ãƒ­ã‚°,log
---

<page-title/>

::: warning å…è²¬äº‹é …

- æœ‰å¿—ã§ä½œæˆã—ãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã‚ã‚‹ã€‚ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼ã«ã¯å¤šæ§˜ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒå­˜åœ¨ã—ã€ãã‚Œãã‚Œã®çŠ¶æ³ã«åˆã‚ã›ã¦å·¥å¤«ã•ã‚ŒãŸé–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ã‚„é«˜åº¦ãªé–‹ç™ºæ”¯æ´ç’°å¢ƒãŒå­˜åœ¨ã™ã‚‹ã€‚æœ¬ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¯ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼ã®å…¨ã¦ã®éƒ¨ç½²ï¼ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§é©ç”¨ã•ã‚Œã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªãã€æœ‰å¿—ãŒè¦³ç‚¹ã‚’æŒã¡å¯„ã£ã¦æ–°ãŸã«æ•´ç†ã—ãŸã‚‚ã®ã§ã‚ã‚‹
- ç›¸å®¹ã‚Œãªã„éƒ¨åˆ†ãŒã‚ã‚Œã°ãã®é ˜åŸŸã‚’æ›¸ãæ›ãˆã¦åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã‚‹ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®èƒŒæ™¯ã‚„è¦ä»¶ã¸ã®é…æ…®ã¯ã€ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³åˆ©ç”¨è€…ãŒæœ€çµ‚çš„ã«åˆ¤æ–­ã™ã‚‹ã“ã¨ã€‚æœ¬ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«å¿…ãšå¾“ã†ã“ã¨ã¯æ±‚ã‚ã¦ãŠã‚‰ãšã€è¨­è¨ˆæ¡ˆã®æç¤ºã¨ã€ãã‚Œã‚‰ã®è©•ä¾¡è¦³ç‚¹ã‚’åˆ©ç”¨è€…ã«æä¾›ã™ã‚‹ã“ã¨ã‚’ä¸»ç›®çš„ã¨ã—ã¦ã„ã‚‹
- æ²è¼‰å†…å®¹ãŠã‚ˆã³åˆ©ç”¨ã«éš›ã—ã¦ç™ºç”Ÿã—ãŸå•é¡Œã€ãã‚Œã«ä¼´ã†æå®³ã«ã¤ã„ã¦ã¯ã€ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼æ ªå¼ä¼šç¤¾ã¯ä¸€åˆ‡ã®è²¬å‹™ã‚’è² ã‚ãªã„ã‚‚ã®ã¨ã™ã‚‹ã€‚æ²è¼‰ã—ã¦ã„ã‚‹æƒ…å ±ã¯äºˆå‘Šãªãå¤‰æ›´ã™ã‚‹å ´åˆãŒã‚ã‚‹

:::

- **å¯¾è±¡ã‚¹ã‚³ãƒ¼ãƒ—**
  - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒå‡ºåŠ›ã™ã‚‹ãƒ­ã‚°ï¼ˆã‚¢ãƒ—ãƒªãƒ­ã‚°ï¼‰ãŒå¯¾è±¡
  - AWS CloudTrailã‚„VPCãƒ•ãƒ­ãƒ¼ãƒ­ã‚°ã¨ã„ã£ãŸã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã‚„ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å´ã§å‡ºåŠ›ã•ã‚Œã‚‹ãƒ­ã‚°ã¯å¯¾è±¡å¤–
  - ä¸»ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é ˜åŸŸã®ãƒ­ã‚°ã‚’æ‰±ã†ã€‚ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ­ã‚°ã«ã¤ã„ã¦ã‚‚ä¸€éƒ¨è¨€åŠã™ã‚‹ãŒã€æœ¬ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã®ä¸»çœ¼ã«ã—ãªã„
- **å‰ææ¡ä»¶**
  - **å®Ÿè¡Œç’°å¢ƒ**: ã‚¯ãƒ©ã‚¦ãƒ‰åˆ©ç”¨ã‚’å‰æã¨ã™ã‚‹ã€‚ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ç’°å¢ƒã§å¿…è¦ã¨ãªã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ã®ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯è€ƒæ…®ã—ãªã„
  - **å‡ºåŠ›æ–¹å¼**: ãƒ­ã‚°ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ãªãã€æ¨™æº–å‡ºåŠ›ã‚’åŸºæœ¬ã¨ã™ã‚‹

# ãƒ­ã‚°ã‚­ãƒ¼å‘½åè¦å‰‡

## æ¨™æº–çš„ãªè¦ç´„

Elastic Common Schema (ECS) ã€OpenTelemetry Semantic Conventionsã®2ã¤ãŒæœ‰åã§ã‚ã‚‹ã€‚2023å¹´ã«OpenTelemetryï¼ˆOTelï¼‰ã«ECSãŒçµ±åˆã•ã‚ŒãŸã€‚ãã®ãŸã‚ã€OTelãŒå®Ÿè³ªçš„ã«æ¨™æº–ã¨è¨€ãˆã‚‹ã€‚

- [Announcing the Elastic Common Schema (ECS) and OpenTelemetry Semantic Convention Convergence](https://opentelemetry.io/blog/2023/ecs-otel-semconv-convergence/)

ã€OTel Semantic Conventions ã¨ECS æ¯”è¼ƒã€‘

| \#             | OpenTelemetry Semantic Conventions                                                                           | Elastic Common Schema (ECS)                                                                        |
| :------------- | :----------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------- |
| èª¬æ˜           | é–‹ç™ºè€…å‘ã‘ã®ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ“ãƒªãƒ†ã‚£ï¼ˆãƒˆãƒ¬ãƒ¼ã‚¹ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒ­ã‚°ã®ç›¸é–¢ï¼‰ã«é‡ç‚¹ã‚’ç½®ãã€‚åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã®æŒ™å‹•è¿½è·¡ã«åˆ©ç”¨ | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æ (SIEM) ã¨é‹ç”¨åˆ†æã«é‡ç‚¹ã‚’ç½®ãã€‚è±Šå¯Œãªã‚¤ãƒ™ãƒ³ãƒˆåˆ†é¡èªå½™ã€ç‰¹ã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†é‡ã«å¼·ã„ |
| æ§‹é€            | ãƒ•ãƒ©ãƒƒãƒˆãªAttributesã¨Resource                                                                               | ãƒã‚¹ãƒˆã•ã‚ŒãŸJSONã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆè«–ç†çš„ã«ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ï¼‰                                               |
| å‘½åè¦å‰‡       | dot.case (ä¾‹: service.name)                                                                                  | dot.case (ä¾‹: service.name)                                                                        |
| ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ— | timestamp (ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«)                                                                                     | @timestamp (ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«)                                                                          |
| ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸     | body (ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«)                                                                                          | message (ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«)                                                                             |
| ã‚µãƒ¼ãƒ“ã‚¹å     | service.name (ãƒªã‚½ãƒ¼ã‚¹å±æ€§)                                                                                  | service.name (ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚»ãƒƒãƒˆ)                                                                    |
| ãƒˆãƒ¬ãƒ¼ã‚¹ID     | traceId (ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«)                                                                                       | trace.id (ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚»ãƒƒãƒˆ)                                                                        |

::: tip OTel ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ä¾‹

```json
{
  "logRecords": [
    {
      "timeUnixNano": "1724737589123456789",
      "observedTimeUnixNano": "1724737589124567890",
      "severityNumber": 17,
      "severityText": "ERROR",
      "body": {
        "stringValue": "Payment processing failed due to insufficient funds"
      },
      "attributes": [
        {
          "key": "http.request.method",
          "value": { "stringValue": "POST" }
        },
        {
          "key": "http.route",
          "value": { "stringValue": "/api/v1/payment" }
        },
        {
          "key": "customer.id",
          "value": { "stringValue": "customer-00123" }
        },
        {
          "key": "payment.processor.error_code",
          "value": { "intValue": 2001 }
        }
      ],
      "traceId": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6",
      "spanId": "1a2b3c4d5e6f7a8b"
    }
  ]
}
```

:::

::: tip ECSãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆä¾‹

```json
{
  "@timestamp": "2025-08-27T13:46:29.123Z",
  "ecs": {
    "version": "8.11.0"
  },
  "log": {
    "level": "error"
  },
  "message": "Payment processing failed due to insufficient funds",
  "service": {
    "name": "checkout-service",
    "version": "1.2.5",
    "instance": {
      "id": "checkout-7b5b76d9c-x4z2l"
    },
    "environment": "production"
  },
  "http": {
    "request": {
      "method": "POST"
    },
    "route": "/api/v1/payment"
  },
  "trace": {
    "id": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6"
  },
  "span": {
    "id": "1a2b3c4d5e6f7a8b"
  },
  "labels": {
    "customer_id": "customer-00123"
  },
  "payment": {
    "processor": {
      "error_code": 2001
    }
  }
}
```

:::

## å„è¨€èªã®ãƒ­ã‚¬ãƒ¼ãŒåˆ©ç”¨ã™ã‚‹ã‚­ãƒ¼å

å„è¨€èªã®æ§‹é€ åŒ–ãƒ­ã‚®ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒåˆ©ç”¨ã™ã‚‹ã‚­ãƒ¼åç§°ã‚’ã¾ã¨ã‚ã‚‹ã€‚

| \#               | Java (Logback \+ logstash-encoder) | Go (æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª `slog`) | Python (æ¨™æº– `logging` \+ python-json-logger) |
| :--------------- | :--------------------------------- | :------------------------- | :-------------------------------------------- |
| ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—   | `@timestamp`                       | `time`                     | `timestamp`                                   |
| ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸       | `message`                          | `msg`                      | `message`                                     |
| ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«       | `level`                            | `level`                    | `levelname`                                   |
| ãƒ•ã‚¡ã‚¤ãƒ«å       | `caller_file_name`                 | `source`                   | `filename`                                    |
| è¡Œç•ªå·           | `caller_line_number`               | `source`                   | `lineno`                                      |
| ã‚¯ãƒ©ã‚¹å         | `caller_class_name`                | è©²å½“ãªã—                   | è©²å½“ãªã—                                      |
| ã‚¹ãƒ¬ãƒƒãƒ‰å       | `thread_name`                      | è©²å½“ãªã—                   | `threadName`                                  |
| ãƒ­ã‚¬ãƒ¼å         | `logger_name`                      | ï¼ˆã‚«ã‚¹ã‚¿ãƒ å±æ€§ï¼‰           | `name`                                        |
| ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ | `stack_trace â€»2`                   | ï¼ˆã‚«ã‚¹ã‚¿ãƒ å±æ€§ï¼‰â€»3         | `exc_info` / `exc_text`                       |

- â€»1: slogã«ã¯ãƒ­ã‚¬ãƒ¼åã¨ã„ã†æ¦‚å¿µãŒç„¡ã„ã€‚slog.With("component", "my-service") ã®ã‚ˆã†ã«ã€ä»»æ„ã§ç´ã¥ã‘ã‚‹ã®ã¿ã§ã‚ã‚‹
- â€»2: `logger.error("ã‚¨ãƒ©ãƒ¼", e);` ã®ã‚ˆã†ã«**ä¾‹å¤–ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**ã‚’æ¸¡ã—ãŸéš›ã«è¿½åŠ ã—ãŸå ´åˆã®ã‚­ãƒ¼å
- â€»3: stackã‚‚ã—ãã¯stacktrace ãŒå¤šãã†ã§ã‚ã‚‹

## Apache / nginx

Apacheã¨nginxã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã§ã‚ˆãåˆ©ç”¨ã•ã‚Œã‚‹ã€æ¨™æº–çš„ãªã‚­ãƒ¼åã‚’ã¾ã¨ã‚ã‚‹ã€‚

| åˆ†é¡                | é …ç›®                   | Apache           | nginx                |
| :------------------ | :--------------------- | :--------------- | :------------------- |
| Combined Log Format | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ | remote_host      | remote_addr          |
|                     | èªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼           | remote_user      | remote_user          |
|                     | ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—         | time             | time_local           |
|                     | ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ©ã‚¤ãƒ³ â€»1    | request          | request              |
|                     | HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰   | status           | status               |
|                     | ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚µã‚¤ã‚º       | bytes_sent       | body_bytes_sent      |
|                     | ãƒªãƒ•ã‚¡ãƒ©               | referer          | http_referer         |
|                     | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ   | user_agent       | http_user_agent      |
|                     | ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†æ™‚é–“     | (è¿½åŠ è¨­å®šãŒå¿…è¦) | request_time         |
|                     | ãƒ—ãƒ­ã‚­ã‚·å…ˆIP (XFF)     | x_forwarded_for  | http_x_forwarded_for |
| ã‚«ã‚¹ã‚¿ãƒ é …ç›®        | HTTPãƒ¡ã‚½ãƒƒãƒ‰           | method           | request_method       |
|                     | ãƒªã‚¯ã‚¨ã‚¹ãƒˆURI          | request_uri      | request_uri          |

â€»1 requestã¯ "GET /index.html HTTP/1.1" ã¨ã„ã£ãŸå½¢å¼ã§ã€HTTPãƒ¡ã‚½ãƒƒãƒ‰ã‚„URIãŒå«ã¾ã‚Œã‚‹ã€‚åˆ†æã‚’å®¹æ˜“ã«ã™ã‚‹ãŸã‚ã‚«ã‚¹ã‚¿ãƒ å±æ€§ã§åˆ†è§£ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚

## ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 

AWSã¨Google Cloudã®ãƒ­ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã«ãŠã‘ã‚‹ã€ç‰¹åˆ¥ãªã‚­ãƒ¼åã‚’ã¾ã¨ã‚ã‚‹ã€‚

| \#             | AWS CloudWatch Logs (Insights)                                                 | Google Cloud Logging (LogEntry)                                                                            |
| :------------- | :----------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------- |
| ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ— | @timestamp                                                                     | timestamp                                                                                                  |
| ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | @message                                                                       | jsonPayload                                                                                                |
| ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«     | (ã‚«ã‚¹ã‚¿ãƒ å±æ€§)                                                                 | severityï¼ˆINFO, ERRORç­‰ã®å€¤ã«å¿œã˜ã¦UIã®ã‚¢ã‚¤ã‚³ãƒ³ã‚„è‰²ãŒå¤‰ã‚ã‚Šã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚‚å®¹æ˜“ï¼‰                        |
| ãƒˆãƒ¬ãƒ¼ã‚¹é€£æº   | â€»å°‚ç”¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãªã—ï¼ˆX-Rayã®ãƒˆãƒ¬ãƒ¼ã‚¹IDã‚’ã‚«ã‚¹ã‚¿ãƒ ã‚­ãƒ¼ã¨ã—ã¦å«ã‚ã‚‹ã“ã¨ãŒä¸€èˆ¬çš„ï¼‰ | traceã€spanIdï¼ˆCloud Traceã¨è‡ªå‹•ã§é€£æºã™ã‚‹ãŸã‚ã®IDã€‚ãƒ­ã‚°ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ä¸Šã§ãƒˆãƒ¬ãƒ¼ã‚¹ã¸ã®ãƒªãƒ³ã‚¯ãŒç”Ÿæˆã•ã‚Œã‚‹ï¼‰ |
| HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ | (ã‚«ã‚¹ã‚¿ãƒ å±æ€§)                                                                 | httpRequestã€‚HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆæƒ…å ±ï¼ˆrequestMethod, status, latencyç­‰ï¼‰ã‚’å…¥ã‚Œã‚‹ã“ã¨ã§ã€ç‰¹åˆ¥ã«è¡¨ç¤ºã•ã‚Œã‚‹        |
| ã‚«ã‚¹ã‚¿ãƒ å±æ€§   | (ã‚«ã‚¹ã‚¿ãƒ å±æ€§)                                                                 | labelsã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–ã•ã‚Œã€é«˜é€Ÿãªæ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã«ä½¿ã„ãŸã„ã‚­ãƒ¼ã‚’æŒ‡å®šã™ã‚‹                             |

- è¦‹è§£
  - ã‚½ãƒ•ãƒˆãªãƒ™ãƒ³ãƒ€ãƒ¼ãƒ­ãƒƒã‚¯ã‚¤ãƒ³ã«ãªã‚‹ãŸã‚ã€ç§»æ¤æ€§ã‚’è€ƒæ…®ã™ã‚‹ã¨OTelã®è¦å‰‡ã‚’ä½¿ã†æ–¹ãŒãƒ™ã‚¿ãƒ¼
  - OTelã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼ãªã©ã€FWãƒ¬ã‚¤ãƒ¤ãƒ¼ãªã©ã§ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸
    - ä¾‹: `trace_id` ã‚’ `logging.googleapis.com/trace` ã«ãƒãƒƒãƒ”ãƒ³ã‚°
- æ€æƒ³ã«ã¤ã„ã¦
  - AWS CloudWatch Logs
    - `@`ã§å§‹ã¾ã‚‹ã„ãã¤ã‹ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’é™¤ãã€ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸(`@message`)ã®ä¸­èº«ã¯è‡ªç”±ã§ã‚ã‚‹ã€‚ã‚¯ã‚¨ãƒªå®Ÿè¡Œæ™‚(ã‚¹ã‚­ãƒ¼ãƒã‚ªãƒ³ãƒªãƒ¼ãƒ‰)ã«å¿…è¦ãªæƒ…å ±ã‚’ãƒ‘ãƒ¼ã‚¹ã™ã‚‹è€ƒãˆæ–¹ãŒåŸºæœ¬
  - Google Cloud Logging
    - `LogEntry`ã¨ã„ã†å³æ ¼ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã‚’æŒã¡ã€`severity`ã‚„`httpRequest`ã¨ã„ã£ãŸå®šç¾©æ¸ˆã¿ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«æ²¿ã£ã¦å‡ºåŠ›ã™ã‚‹(ã‚¹ã‚­ãƒ¼ãƒã‚ªãƒ³ãƒ©ã‚¤ãƒˆ)ã“ã¨ã§ã€ç‰¹åˆ¥ãªUIè¡¨ç¤ºã‚„Cloud Traceã¨ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«é€£æºã•ã›ã‚‹ã¨ã„ã†æ€æƒ³ã§ã‚ã‚‹

::: tip AWS CloudWatch Logs ã® Embedded Metric Format (EMF)  
AWS CloudWatch Logsã«ã¯ã€EMFã¨ã„ã†ãƒ­ã‚°ã‚¤ãƒ™ãƒ³ãƒˆå†…ã«ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’åŸ‹ã‚è¾¼ã‚€ãŸã‚ã®JSONä»•æ§˜ãŒã‚ã‚‹ã€‚ã“ã‚Œã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€PutMetricDataã®ã‚ˆã†ãªåŒæœŸçš„APIã‚’å‘¼ã³å‡ºã•ãšã€ç‰¹å®šã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ­ã‚°ã‚’æ¨™æº–å‡ºåŠ›ã«æ›¸ãå‡ºã™ã ã‘ã§ãƒ¡ãƒˆãƒªã‚¯ã‚¹é€£æºãŒã§ãã‚‹ã€‚

- [ä»•æ§˜: åŸ‹ã‚è¾¼ã¿ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ \- Amazon CloudWatch](https://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/monitoring/CloudWatch_Embedded_Metric_Format_Specification.html)

:::

## SaaSã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ“ãƒªãƒ†ã‚£ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 

NewRelicã€DataDogãªã©ã‚‚ç‹¬è‡ªã®ã‚­ãƒ¼ãŒã‚ã‚‹ãŒã€OTelã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼ãªã©ã®å¯¾å¿œãŒç©æ¥µçš„ã§ã‚ã‚‹ãŸã‚ã€ãã®å±¤ã§å¸åã™ã‚‹æ–¹é‡ãŒå¦¥å½“ã ã¨è€ƒãˆã‚‰ã‚Œã‚‹ã€‚

| \#                                   | DataDog ã‚­ãƒ¼ | New Relic ã‚­ãƒ¼ | OpenTelemetry ç›¸å½“è¦ç´„ |
| :----------------------------------- | :----------- | :------------- | :--------------------- |
| ãƒˆãƒ¬ãƒ¼ã‚¹ID                           | dd.trace_id  | trace.id       | trace_id               |
| ã‚¹ãƒ‘ãƒ³ID                             | dd.span_id   | span.id        | span_id                |
| ã‚µãƒ¼ãƒ“ã‚¹å                           | service      | entity.name    | service.name           |
| ç’°å¢ƒ                                 | env          | (ã‚«ã‚¹ã‚¿ãƒ å±æ€§) | deployment.environment |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³                           | version      | (ã‚«ã‚¹ã‚¿ãƒ å±æ€§) | service.version        |
| ãƒ›ã‚¹ãƒˆ                               | host         | hostname       | host.name              |
| ãƒ­ã‚°é‡è¦åº¦ãƒ¬ãƒ™ãƒ«                     | status       | TODO           | TODO                   |
| ãƒ­ã‚°ç”Ÿæˆå…ƒ ï¼ˆnginxã€postgresqlãªã©ï¼‰ | source       | TODO           | TODO                   |

## æ¨å¥¨ã™ã‚‹ã‚­ãƒ¼åç§°

æ–¹é‡ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

1. OTelæº–æ‹ ã¨ECSã®èªå½™ã‚’å–ã‚Šå…¥ã‚Œã‚‹
   - å¯èƒ½ãªé™ã‚ŠOpenTelemetryã®ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯è¦ç´„ã®å‘½åè¦å‰‡ã«å¾“ã†
   - ä¸è¶³ã—ã¦ã„ã‚Œã°ã€ECSã®èªå½™ã‚’å–ã‚Šå…¥ã‚Œã‚‹
   - ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ãŒ `severity.text` ã«ãªã‚‹ãªã©ã€å–ã‚Šå…¥ã‚Œã‚‹ã“ã¨ãŒå³ã—ã„å ´åˆã¯ã€ `level` ãªã©ã«ä¸€éƒ¨ã ã‘æ›¸ãæ›ãˆã‚‹ã“ã¨ã‚’æƒ³å®šã™ã‚‹ã€‚ãŸã ã—ã€æŠ€è¡“æ¨™æº–ãŒã‚ã‚‹ä»¥ä¸Šã€é•·æœŸçš„ã«æº–æ‹ ã—ã¦ã„ã
2. ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ éä¾å­˜
   - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰å†…ã§å‡ºåŠ›ã™ã‚‹ã‚­ãƒ¼ã¯ã€ç‰¹å®šã®ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚„SaaSãƒ™ãƒ³ãƒ€ãƒ¼ã«å›ºæœ‰ã®ã‚­ãƒ¼ã‚’å«ã¾ãªã„
   - ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å›ºæœ‰ã®ã‚­ãƒ¼ã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã¯ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆãƒ­ã‚°ã‚³ãƒ¬ã‚¯ã‚¿ãƒ¼ï¼‰ã®è²¬å‹™ã«ï¼ˆã§ãã‚‹é™ã‚Šï¼‰ã™ã‚‹
3. å…¨ã¦ã®ãƒ­ã‚°ã«å¿…é ˆã®ã€Œå…±é€šã‚¹ã‚­ãƒ¼ãƒã€ã¨ã€ç‰¹å®šã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼ˆä¾‹: HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒªï¼‰ã«å¿œã˜ã¦è¿½åŠ ã•ã‚Œã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã€Œæ‹¡å¼µã‚¹ã‚­ãƒ¼ãƒã€ã‚’æŒã¤ã€éšå±¤çš„ãªæ§‹é€ ã¨ã™ã‚‹

| å¤§åˆ†é¡       | å°åˆ†é¡           | ã‚­ãƒ¼å                                                                 | èª¬æ˜                                         | ä¾‹                                    | ç†ç”±                                                                                                                                                                    |
| :----------- | :--------------- | :--------------------------------------------------------------------- | :------------------------------------------- | :------------------------------------ | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| å…±é€šã‚¹ã‚­ãƒ¼ãƒ | ã‚³ã‚¢ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰   | timestamp                                                              | ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã€‚å¯èª­æ€§ã®é«˜ã„ISO 8601å½¢å¼     | "2025-08-26T10:30:00.123456789Z"      | OTel, ECSã®ä¸¡æ–¹ã§å¿…é ˆ                                                                                                                                                   |
|              |                  | severity.text ï¼ˆâ€»ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ˆã£ã¦ã¯levelã®ã¾ã¾ã§ã‚‚è¨±å®¹ï¼‰ | äººé–“ãŒèª­ã‚€ãŸã‚ã®ä¸»è¦ãªé‡å¤§åº¦ãƒ¬ãƒ™ãƒ«           | "ERROR"                               | OTelè¦ç´„ã«æº–æ‹ ã€‚ecsã§ã¯ [log.level](https://www.elastic.co/docs/reference/ecs/ecs-log#field-log-level)                                                                  |
|              |                  | message                                                                | ãƒ­ã‚°ã®ä¸»è¦ãªãƒšã‚¤ãƒ­ãƒ¼ãƒ‰                       | "User login failed"                   | OTelã®Bodyã«ç›¸å½“ã€‚ECSã§ã¯[message](https://www.elastic.co/docs/reference/ecs/ecs-base#field-message)                                                                    |
|              | ãƒ­ã‚¬ãƒ¼ã§è‡ªå‹•ä»˜ä¸ | service.name                                                           | ã‚·ã‚¹ãƒ†ãƒ å†…ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚’è­˜åˆ¥ã™ã‚‹æœ€ã‚‚é‡è¦ãªå±æ€§ | "authentication-service"              | OTel, ECS, DataDog, New Relicå…¨ã¦ã§ä¸­æ ¸                                                                                                                                 |
|              |                  | service.version                                                        | ãƒªãƒªãƒ¼ã‚¹ã®è¿½è·¡ã¨ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³åˆ†æã«ä¸å¯æ¬    | "1.2.3"                               | OTel, ECS, DataDogã§æ¨™æº–                                                                                                                                                |
|              |                  | deployment.environment                                                 | æœ¬ç•ª/ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã«å¿…é ˆ  | "production"                          | OTel, DataDogã§æ¨™æº–                                                                                                                                                     |
|              | è¨ˆè£…ã§è‡ªå‹•ä»˜ä¸   | trace_id                                                               | åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚¹ã¸ã®åŸºæœ¬çš„ãªãƒªãƒ³ã‚¯               | "a1b2c3d4e5f6..."                     | OTel, ECS, New Relicã«æº–æ‹ ï¼ˆDataDogã¯dd.trace_idã«ãƒãƒƒãƒ”ãƒ³ã‚°è¦ï¼‰                                                                                                        |
|              |                  | span_id                                                                | ãƒˆãƒ¬ãƒ¼ã‚¹å†…ã®ç‰¹å®šã®æ“ä½œã¸ã®ãƒªãƒ³ã‚¯             | "f1e2d3c4b5a6..."                     | OTel, ECS, New Relicã«æº–æ‹ ï¼ˆDataDogã¯dd.span_idã«ãƒãƒƒãƒ”ãƒ³ã‚°è¦ï¼‰                                                                                                         |
| æ‹¡å¼µã‚¹ã‚­ãƒ¼ãƒ | HTTPè¦æ±‚/å¿œç­”    | http.request.method                                                    | HTTPãƒ¡ã‚½ãƒƒãƒ‰                                 | "GET"                                 | `OTelã¨ECSã®HTTPè¦ç´„ã‹ã‚‰è¦å®š`                                                                                                                                           |
|              |                  | http.response.status_code                                              | HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰                         | 200                                   |                                                                                                                                                                         |
|              |                  | url.path                                                               | ãƒªã‚¯ã‚¨ã‚¹ãƒˆURL                                | "/users/123?query=abc"                | OTelã§ã¯[url.path](https://opentelemetry.io/docs/specs/semconv/registry/attributes/url/#url-path)                                                                       |
|              |                  | user_agent.original                                                    | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ                         | "Mozilla/5.0..."                      |                                                                                                                                                                         |
|              |                  | client.address                                                         | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹                       | "192.0.2.1"                           | OTelã§ã¯[client.address](https://opentelemetry.io/docs/specs/semconv/registry/attributes/client/#client-address)                                                        |
|              |                  | http.request.body.size                                                 | ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã®ãƒã‚¤ãƒˆæ•°                   | 1024                                  | OTelã§ã¯[http.request.body.size](https://opentelemetry.io/docs/specs/semconv/registry/attributes/http/#http-request-body-size)                                          |
|              |                  | http.server.request.duration                                           | å‡¦ç†æ™‚é–“ï¼ˆãƒŠãƒç§’ï¼‰                           | 125000000                             | OTelã§ã¯[http.server.request.duration](https://github.com/open-telemetry/semantic-conventions/blob/v1.37.0/docs/http/http-metrics.md)                                   |
|              | DB               | db.system                                                              | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç¨®é¡                           | "postgresql"                          | OTelã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¦ç´„ã«åŸºã¥ã`                                                                                                                                         |
|              |                  | db.statement                                                           | å®Ÿè¡ŒSQLæ–‡                                    | "SELECT \* FROM users WHERE id \=?"   |                                                                                                                                                                         |
|              |                  | db.operation                                                           | å®Ÿè¡Œæ“ä½œ                                     | "SELECT"                              |                                                                                                                                                                         |
|              |                  | db.duration                                                            | ã‚¯ã‚¨ãƒªå®Ÿè¡Œæ™‚é–“ï¼ˆãƒŠãƒç§’ï¼‰                     | 15000000                              |                                                                                                                                                                         |
|              | ä¾‹å¤–             | exception.type                                                         | ä¾‹å¤–ã‚¯ãƒ©ã‚¹å                                 | "java.lang.NullPointerException"      | OTelã§ã¯[exception](https://opentelemetry.io/docs/specs/semconv/exceptions/exceptions-logs)ã‚’åˆ©ç”¨ã€‚ecsã§ã¯ [error](https://www.elastic.co/docs/reference/ecs/ecs-error) |
|              |                  | exception.message                                                      | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸                             | "Cannot invoke method on null object" |                                                                                                                                                                         |
|              |                  | exception.stack_trace                                                  | ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹                             | "at com.example.MyClass..."           |                                                                                                                                                                         |
|              |                  | event.kind                                                             | ã‚¤ãƒ™ãƒ³ãƒˆã®ç¨®é¡                               | "event"                               | ecsã§ã¯ [event](https://www.elastic.co/docs/reference/ecs/ecs-event)                                                                                                    |
|              |                  | event.category                                                         | ã‚¤ãƒ™ãƒ³ãƒˆã®ã‚«ãƒ†ã‚´ãƒª                           | "error"                               |                                                                                                                                                                         |
|              |                  | event.outcome                                                          | ã‚¤ãƒ™ãƒ³ãƒˆã®çµæœ                               | "failure"                             |                                                                                                                                                                         |

# ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

ãƒ­ã‚°ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ã¯æ§‹é€ åŒ–ãƒ­ã‚°ã§ã‚ã‚‹ã€JSONLinesã‚’åˆ©ç”¨ã™ã‚‹ã€‚

- RFC 8259ã§ä»•æ§˜ãŒæ¨™æº–åŒ–ã•ã‚Œã¦ãŠã‚Šã€æ•°å€¤å‹ã‚„çœŸå½å€¤ãªã©ã®ãƒ‡ãƒ¼ã‚¿å‹ãŒåˆ©ç”¨ã§ãã‚‹ãŸã‚ã€‚å¹…åºƒãåˆ©ç”¨ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€CloudWatch Logsã‚„BigQueryç­‰ã®å¤šãã®ã‚µãƒ¼ãƒ“ã‚¹ã‚„ãƒ„ãƒ¼ãƒ«ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€‚
- Apache Combined Formatã‚„LTSVï¼ˆLabeled Tab-Separated Valuesï¼‰ã¯ä¿¡é ¼ã§ãã‚‹ä»•æ§˜ãŒå­˜åœ¨ã—ãªã„ã€‚

## ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®å ´åˆ

ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã«é™ã£ã¦ã¯ã€JSON Linesã§ã¯ãªãéæ§‹é€ ãªãƒ­ã‚°å½¢å¼ã‚‚è¨±å®¹ã™ã‚‹ï¼ˆæ§‹é€ åŒ–ãƒ­ã‚®ãƒ³ã‚°ã®ã¾ã¾ã§ã‚‚è‰¯ã„ï¼‰ã€‚

::: tip çµµæ–‡å­—ã§ã‚«ãƒ©ãƒ•ãƒ«ã«  
ç‰¹ã«ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã—ã‹åˆ©ç”¨ã—ãªã„å ´åˆã¯ã€ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«çµµæ–‡å­—ã‚’å…¥ã‚Œã‚‹ã¨è¦–èªæ€§ãŒå‘ä¸Šã—ã‚„ã™ã„ã¨ã„ã†ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ãŒã‚ã‚‹ã€‚

```console
DEBUG: Order #ORD-123 ã®å‡¦ç†ã‚’é–‹å§‹ã—ã¾ã™ã€‚ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: PENDING â³
DEBUG: åœ¨åº«ã‚’ç¢ºèªä¸­... å•†å“ID: P-123 ã®åœ¨åº«ã¯ 10å€‹ã§ã™ âœ…
DEBUG: æ³¨æ–‡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ PROCESSING âš™ï¸ ã«æ›´æ–°ã—ã¾ã—ãŸã€‚
DEBUG: æœ€çµ‚çš„ãªåˆè¨ˆé‡‘é¡ã‚’è¨ˆç®—ã—ã¾ã—ãŸ: ğŸ’° 10000å††
DEBUG: ãƒ¦ãƒ¼ã‚¶ãƒ¼ customer@example.com å®›ã«ç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã™ ğŸ“§
DEBUG: æ³¨æ–‡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ COMPLETED âœ¨ ã«æ›´æ–°ã—ã¾ã—ãŸã€‚
DEBUG: Order #ORD-123 ã®å‡¦ç†ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸ ğŸ‰
```

é©åˆ‡ãªçµµæ–‡å­—ã‚’ä½¿ã†ã“ã¨ã§ã€ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¦‹é€ƒã—ã‚’é˜²ãã“ã¨ãŒã§ãã‚‹ã€‚ãƒ‡ãƒãƒƒã‚°ä¸­ã®å¿ƒç†çš„ãªè² æ‹…ã‚’æŠ‘åˆ¶ã§ãã‚‹ã¨ã„ã†å£°ã‚‚ã‚ã‚‹ã€‚ãŸã ã—ã€ã‚ãã¾ã§é–‹ç™ºç’°å¢ƒé™å®šã¨ã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆç’°å¢ƒã§ã¯ã“ã†ã„ã£ãŸçµµæ–‡å­—ã¯å‡ºã•ãªã„ï¼ˆãƒã‚¤ã‚ºã¨ãªã‚‹ãŸã‚ï¼‰ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã€‚

:::

::: tip ANSIã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã§ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’å½©ã‚‹  
ãƒ¢ãƒ€ãƒ³ãªãƒ­ã‚®ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæ™®åŠã™ã‚‹å‰ã¯ã€ANSIã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã¨å‘¼ã°ã‚Œã‚‹ç‰¹æ®Šãªæ–‡å­—åˆ—ã‚’ãƒ­ã‚°ã«åŸ‹ã‚è¾¼ã‚€ã“ã¨ã§ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ãƒ­ã‚°å‡ºåŠ›ã«è‰²ã‚’ä»˜ã‘ã¦è¦–èªæ€§ã‚’é«˜ã‚ã‚‹ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ãŒä½¿ã‚ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã£ãŸã€‚

- \\u001B\[31m: èµ¤è‰²
- \\u001B\[33m: é»„è‰²
- \\u001B\[32m: ç·‘è‰²
- \\u001B\[0m: è£…é£¾ã‚’ãƒªã‚»ãƒƒãƒˆ

```java
// Javaã§ã®å‡ºåŠ›ä¾‹
System.out.println("\u001B[31m" + "ERROR" + "\u001B[0m" + ": Critical failure detected.");
System.out.println("\u001B[33m" + "WARN" + "\u001B[0m" + ": API response is slow.");
```

ANSIã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã®ã‚ˆãã‚ã‚‹èª²é¡Œã¯ã€ANSIã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’è§£é‡ˆã§ããªã„ç’°å¢ƒã§ã¯ã€ãŸã ã®ãƒã‚¤ã‚ºã®å¤šã„æ–‡å­—åˆ—ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã¦ã—ã¾ã†ã“ã¨ã§ã‚ã‚‹ã€‚ä¾‹ãˆã°ã€ãƒ­ã‚°ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆ\>ï¼‰ã—ã¦ã€å¾Œã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã§é–‹ã„ãŸã‚Šã€CI/CDãƒ„ãƒ¼ãƒ«ã®ãƒ­ã‚°ãƒ“ãƒ¥ãƒ¼ã‚¢ã§è¡¨ç¤ºã—ãŸã‚Šã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãŒãã®ã¾ã¾è¡¨ç¤ºã•ã‚Œã€è¦–èªæ€§ãŒä½ä¸‹ã™ã‚‹ã€‚

```shell
# åˆ¶å¾¡ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãŒè¡¨ç¤ºã•ã‚ŒãŸãƒ­ã‚°ã®ä¾‹
^[[31mERROR^[[0m: Critical failure detected.
^[[33mWARN^[[0m: API response is slow.
```

ãã®ãŸã‚ã€é«˜æ€§èƒ½ãªãƒ­ã‚®ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆLogback, Log4j2ãªã©ï¼‰ã§ã¯ã€å‡ºåŠ›å…ˆãŒè‰²è¡¨ç¤ºã«å¯¾å¿œã—ãŸã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼ˆTTYï¼‰ã§ã‚ã‚‹ã‹ã‚’è‡ªå‹•çš„ã«åˆ¤åˆ¥ã—ã€å¯¾å¿œã—ã¦ã„ã‚‹å ´åˆã®ã¿å®‰å…¨ã«è‰²ã‚’ä»˜ã‘ã‚‹ã¨ã„ã£ãŸæ©Ÿèƒ½ã‚’æŒã¤ã‚‚ã®ãŒã‚ã‚‹ã€‚

ä¾¿åˆ©ãªå ´é¢ã‚‚ã‚ã‚‹ãŒã€ã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒã§ã¯ãƒ‘ãƒ¼ã‚¹ã®è² è·ãŒã‹ã‹ã‚‹ã ã‘ã§ã‚ã‚Šã€ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ãƒŸã‚¹ãªã©ã®äº‹æ•…ã‚‚å¤šã„ãŸã‚ã€åŸå‰‡ã€ANSIã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã¯åˆ©ç”¨ã—ãªã„ã€‚

:::

# å‡ºåŠ›é …ç›®

## ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«

ä¸»è¦ãªãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã¯ä¸‹è¡¨ã®é€šã‚Šã€‚ [RFC 5424 - The Syslog Protocol](https://tex2e.github.io/rfc-translater/html/rfc5424.html)ã®Severityå®šç¾©ã€ãŠã‚ˆã³Androidã®[ãƒ­ã‚®ãƒ³ã‚°å®šç¾©](https://source.android.com/docs/core/tests/debug/understanding-logging?hl=ja)ã¨æ•´åˆæ€§ã‚’æŒãŸã›ã€ã‚·ã‚¹ãƒ†ãƒ ã®é‹ç”¨ç›£è¦–ã¨é–‹ç™ºåŠ¹ç‡ã®ä¸¡ç«‹ã‚’ç›®æŒ‡ã™ã€‚

ã€å‡¡ä¾‹ã€‘ âœ…ï¸:ãƒ­ã‚°å‡ºåŠ›ã‚’è¡Œã†

| ãƒ¬ãƒ™ãƒ« | èª¬æ˜     | ç›®çš„                                                                                                                  | ãƒ­ãƒ¼ã‚«ãƒ« | é–‹ç™º | æ¤œè¨¼ | æœ¬ç•ª |
| :----- | :------- | :-------------------------------------------------------------------------------------------------------------------- | :------- | :--- | :--- | :--- |
| FATAL  | è‡´å‘½çš„   | ã€ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢ã€‘ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¶™ç¶šãŒä¸å¯èƒ½ãªã‚¨ãƒ©ãƒ¼ã€‚ã‚µãƒ¼ãƒ“ã‚¹ã‚’åœæ­¢ã•ã›ã‚‹ã€‚å¿…é ˆã®ç’°å¢ƒå¤‰æ•°ãŒæœªè¨­å®šãªã©ã€‚           | âœ…ï¸       | âœ…ï¸   | âœ…ï¸   | âœ…ï¸   |
| ERROR  | ã‚¨ãƒ©ãƒ¼   | ã€è¦å¯¾å¿œã€‘ ç‰¹å®šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†ã¯å¤±æ•—ã—ãŸãŒã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è‡ªä½“ã¯å‹•ä½œã‚’ç¶™ç¶šã§ãã‚‹ã‚¨ãƒ©ãƒ¼ã€‚å‡¦ç†ä¸­ã®äºˆæœŸã›ã¬ä¾‹å¤–ãªã©   | âœ…ï¸       | âœ…ï¸   | âœ…ï¸   | âœ…ï¸   |
| WARN   | è­¦å‘Š     | ã€æ½œåœ¨çš„ãªå•é¡Œã€‘ ç›´ã¡ã«ã‚¨ãƒ©ãƒ¼ã§ã¯ãªã„ãŒã€å°†æ¥ï¼ˆNå–¶æ¥­æ—¥ä»¥å†…ï¼‰ã«å¯¾å¿œãŒå¿…è¦ãªçŠ¶æ…‹ã€‚è¨¼æ˜æ›¸ã®æœŸé™åˆ‡ã‚Œã¾ã§1ãƒ¶æœˆã‚’åˆ‡ã£ãŸãªã© | âœ…ï¸       | âœ…ï¸   | âœ…ï¸   | âœ…ï¸   |
| INFO   | æƒ…å ±     | ã€å‹•ä½œè¨˜éŒ²ã€‘ é‹ç”¨è€…ãŒã‚·ã‚¹ãƒ†ãƒ ã®æ­£å¸¸æ€§ã‚’åˆ¤æ–­ã™ã‚‹ãŸã‚ã®ã€ãƒ“ã‚¸ãƒã‚¹ãƒ—ãƒ­ã‚»ã‚¹ä¸Šã®é‡è¦ãªã‚¤ãƒ™ãƒ³ãƒˆã€‚ãƒãƒƒãƒå‡¦ç†ã®é–‹å§‹/çµ‚äº† ãªã© | âœ…ï¸       | âœ…ï¸   | âœ…ï¸   | âœ…ï¸   |
| DEBUG  | ãƒ‡ãƒãƒƒã‚° | ã€é–‹ç™ºè€…å‘ã‘ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã€‘ é–‹ç™ºè€…ãŒãƒã‚°ã‚’ä¿®æ­£ã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹è©³ç´°æƒ…å ±ã€‚å®Ÿè¡Œã•ã‚ŒãŸSQLã‚¯ã‚¨ãƒªãªã©                        | âœ…ï¸       | âœ…ï¸   |      |      |
| TRACE  | ãƒˆãƒ¬ãƒ¼ã‚¹ | ã€é–‹ç™ºè€…å‘ã‘è©³ç´°è¿½è·¡æƒ…å ±ã€‘ `DEBUG`ã‚ˆã‚Šæ›´ã«è©³ç´°ãªã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œæƒ…å ±ã€‚ãƒ¡ã‚½ãƒƒãƒ‰ã®é–‹å§‹/çµ‚äº†ãªã©                             | âœ…ï¸       |      |      |      |

æ¨å¥¨ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

- ã‚¢ãƒ—ãƒªã‹ã‚‰ã®å€‹åˆ¥ãƒ­ã‚¸ãƒƒã‚¯ã§ã¯ã€`DEBUG` ï½ `ERROR` ã‚’åˆ©ç”¨ã™ã‚‹
  - å„ã‚¢ãƒ—ãƒªã‹ã‚‰ã¯ã€`TRACE` `FATAL` ï¼ˆ`CRITICAL`ï¼‰ã¯åˆ©ç”¨ã—ãªã„ï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚„å…±é€šãƒ©ã‚¤ãƒ–ãƒ©ãƒªå´ã¯åˆ©ç”¨ã™ã‚‹å¯èƒ½æ€§ã‚ã‚Šï¼‰
- ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆç’°å¢ƒï¼ˆdev, stg, prodï¼‰ã§ã®æ¨å¥¨å‡ºåŠ›ãƒ¬ãƒ™ãƒ«ã¯ä¸Šè¡¨ã®é€šã‚Šã¨ã™ã‚‹
  - ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆç’°å¢ƒã®ã†ã¡ã€é–‹ç™ºç’°å¢ƒã¯ã€SQLãƒ­ã‚°ãªã©ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã‚‚å¤šã„ãŸã‚ `DEBUG` ã«ã™ã‚‹
  - ãŸã ã—ã€æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã‚’ç§»è¡Œã™ã‚‹ãªã©ã€ãƒ‡ãƒ¼ã‚¿èµ·å› ã§å¤§é‡ã«ãƒ­ã‚°å‡ºåŠ›ãŒã‚ã‚Šãˆã‚‹å ´åˆã¯ã€ `INFO` ãƒ¬ãƒ™ãƒ«ã¸äº‹å‰ã«åˆ‡ã‚Šä¸Šã’ã‚‹
- ç’°å¢ƒå¤‰æ•°ï¼ˆ `LOG_LEVEL` ï¼‰ã§åˆ‡ã‚Šæ›¿ãˆå¯èƒ½ã«ã™ã‚‹
- `/loggers` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚„ã€JMX (Java Management Extensions) ã‚’åˆ©ç”¨ã—ã¦ã€å¤–éƒ¨ã‹ã‚‰ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’å‹•çš„ã«å¤‰æ›´å¯èƒ½ã«ã™ã‚‹ã“ã¨ã¯éæ¨å¥¨ã¨ã™ã‚‹
  - CI/CDãŒç™ºé”ã—ãŸæ˜¨ä»Šã§ã‚ã‚Œã°ã€ç›´æ¥Terraformãªã©ã®ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã§ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½ã§ã‚ã‚‹ãŸã‚
  - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã€å…¬é–‹æ©Ÿèƒ½ã¯æœ€å°é™ã«ã—ãŸã„ãŸã‚
  - ã‚³ãƒ³ãƒ†ãƒŠã§ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã¨LBçµŒç”±ã§æ“ä½œã™ã‚‹ã“ã¨ã«ãªã‚Šã€ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã®æ›¸ãæ›ãˆã‚’é©åˆ‡ã«åæ˜ ã•ã›ã‚‹ã“ã¨ãŒå›°é›£ã§ã‚ã‚‹ãŸã‚

## é€šçŸ¥ãƒ•ãƒ©ã‚°

ã‚¨ãƒ©ãƒ¼ãªã©ãŒç™ºç”Ÿã—ãŸæ™‚ã«ã€ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ã«ãƒ¡ãƒ¼ãƒ«ã‚„Slackã§é€šçŸ¥ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚å¤§é‡ã®ä¸è¦ãªã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥ã«æ™’ã•ã‚Œã‚‹ã¨ã€é‡è¦ãªé€šçŸ¥ã‚’è¦‹é€ƒã™ã“ã¨ã«ç¹‹ãŒã‚‹ãŸã‚ã€ã€Œæœ¬å½“ã«äººé–“ãŒç¢ºèªã™ã¹ãã“ã¨ã€ã‚’é€šçŸ¥ã™ã‚‹è¨­è¨ˆãŒå¿…è¦ã§ã‚ã‚‹ã€‚ãƒ­ã‚°ã®é€šçŸ¥åˆ¤å®šæ–¹æ³•ã¨ã—ã¦ã¯ã€ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã§è¡Œã†ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨é€šçŸ¥ãƒ•ãƒ©ã‚°ã¨ã„ã†é …ç›®ã§åˆ¶å¾¡ã™ã‚‹æ–¹æ³•ãŒã‚ã‚‹ã€‚

æ¨å¥¨ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

- åŸºæœ¬çš„ã«ã€ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ï¼ˆWARNã€ERRORï¼‰ã§é€šçŸ¥ã®åˆ¶å¾¡ã‚’å®Œçµã•ã›ã‚‹ã“ã¨ãŒã§ããªã„ã‹æ¤œè¨ã™ã‚‹ï¼ˆé€šçŸ¥ãƒ•ãƒ©ã‚°ã®å°å…¥ç„¡ã—ã§é‹ç”¨ã§ããªã„ã‹è€ƒãˆã‚‹ï¼‰
  - WARNã€ERRORä»¥ä¸Šã¯ä¸€å¾‹ã€é€šçŸ¥ã™ã‚‹ã¨ã„ã†ã‚·ãƒ³ãƒ—ãƒ«ãªè¨­è¨ˆã‚’å®Ÿç¾ã§ãã‚‹
- é€šçŸ¥ãƒ•ãƒ©ã‚°ã‚’å°å…¥ã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®æ¡ä»¶ã®ã„ãšã‚Œã‹ãŒå¿…è¦ã«ãªã£ãŸå ´åˆã®ã¿ã¨ã™ã‚‹
  - INFOãƒ¬ãƒ™ãƒ«ã§ã‚‚é€šçŸ¥ã—ãŸã„ã‚±ãƒ¼ã‚¹ï¼ˆä¾‹. é‡è¦ãªãƒãƒƒãƒã®å®Œäº†é€šçŸ¥ï¼‰ã€‚ç‰¹ã«ã€ã‚¢ãƒ—ãƒªä¸Šã«é€šçŸ¥å‡¦ç†ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã®ã§ã¯ãªãã€ãƒ­ã‚°é€šçŸ¥ã®ä»•çµ„ã¿ã«ä¹—ã£ã‹ã‚ŠãŸã„å ´åˆ
  - ã‚³ãƒ¼ãƒ‰ä¿®æ­£ãªã—ã«ã€ã€Œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å®šç¾©æ›¸ã€ã ã‘ã§ã€é€šçŸ¥ã®ON/OFFã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆ
    - ã“ã®å ´åˆã€ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã¨é€šçŸ¥ã®æœ‰ç„¡ã¯ã€ç›´æ¥çš„ã«ã¯ç„¡é–¢ä¿‚ã«ãªã‚‹ã€‚å®Ÿè£…ä¸Šã¯ã€ç‰¹å®šã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ä»¥ä¸Šã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é€šçŸ¥ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã¦ãŠãã¨ã€å®Ÿè£…æ™‚ã«é€šçŸ¥ãƒ•ãƒ©ã‚°ã‚’ä»˜ä¸ã™ã‚‹ã‹ã©ã†ã‹ã®åˆ¤æ–­ã‚„æ‰‹é–“ã‚’æ¸›ã‚‰ã™ã“ã¨ãŒã§ãã‚‹
    - ã‚ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸IDã®é€šçŸ¥æœ‰ç„¡ã‚’å¤‰ãˆãŸã„å ´åˆã«ã€è¤‡æ•°ç®‡æ‰€ãŒã‚ã‚Šä¿®æ­£æ¼ã‚Œã®å¯èƒ½æ€§ã‚’è¨±å®¹ã§ããªã„ã€é™çš„è§£æãªã©ã§æ‹…ä¿ã§ããªã„å ´åˆãªã©

::: tip ERRORãƒ¬ãƒ™ãƒ«ã§ã‚‚é€šçŸ¥ã•ã›ãŸããªã„å ´åˆãŒã‚ã‚‹ï¼Ÿ  
ä¾‹ãˆã°ã€å¤–éƒ¨APIã®ä¸€æ™‚çš„ãªæ¥ç¶šã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸãŒã€ãƒªãƒˆãƒ©ã‚¤ã§æˆåŠŸã™ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ãŸã‚ã€ãã®ERRORãƒ¬ãƒ™ãƒ«ã®ãƒ­ã‚°ã¯é€šçŸ¥ã•ã›ãŸããªã„ã¨ã„ã†å ´åˆãŒã‚ã‚‹ã€‚ã—ã‹ã—ã€ã“ã‚Œã¯é€šçŸ¥ãƒ•ãƒ©ã‚°ã§åˆ¶å¾¡ã™ã‚‹ã®ã§ã¯ãªãã€é€šçŸ¥ãŒä¸è¦ã§ã‚ã‚Œã°INFOãƒ¬ãƒ™ãƒ«ã«ã™ã¹ãã§ã‚ã‚‹ã€‚  
:::

## ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰

- ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’é‹ç”¨è€…ãŒå‚ç…§ã™ã‚‹ã€Œé‹ç”¨æ‰‹é †æ›¸ï¼ˆéšœå®³å¯¾å¿œãƒãƒ‹ãƒ¥ã‚¢ãƒ«ï¼‰ã€ã¨ç´ã¥ã‘ã‚‹ãŸã‚ã«ã€é–‹ç™ºè€…ã¯ãƒ­ã‚°ã‚’ä¸€æ„ã«è­˜åˆ¥ã§ãã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰ã‚’ä»˜ä¸ã™ã‚‹
  - è‡ªç„¶è¨€èªã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€é–‹ç™ºè€…ã«ã‚ˆã£ã¦è¡¨ç¾ãŒæºã‚‰ã„ã ã‚Šã€åŒã˜æ–‡é¢ã§ã‚‚ç™ºç”Ÿç®‡æ‰€ã«ã‚ˆã£ã¦æ„å‘³ãŒç•°ãªã£ãŸã‚Šã™ã‚‹ã“ã¨ãŒã‚ã‚‹ãŸã‚
- é‹ç”¨è€…ã®å¯¾å¿œãŒå¿…è¦ãªãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ï¼ˆä¾‹. WARNä»¥ä¸Šï¼‰ã«ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰è¨­å®šã™ã‚‹

::: tip INFOãƒ¬ãƒ™ãƒ«ã«ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰ã®è¨­å®šã¯ä¸è¦
ã‚ãã¾ã§ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰ã®ç®¡ç†ã¯ã€é‹ç”¨æ‰‹é †ã¨ç´ã¥ã‹ã›ã‚‹ãŸã‚ã«è¨­å®šã™ã‚‹ã€‚INFOãƒ¬ãƒ™ãƒ«ã®ãƒ­ã‚°ã¯é€šçŸ¥ãƒ•ãƒ©ã‚°ãªã©ã®åˆ¶å¾¡ã‚’å°å…¥ã—ãªã„é™ã‚Šã€ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ã«é€šçŸ¥ã•ã‚Œãªã„ãŸã‚ã€ã‚ãã¾ã§é–‹ç™ºè€…ã®å‹•ä½œç¢ºèªãªã©ç›®çš„ã§å‡ºåŠ›ã—ã¦è‰¯ãã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰ã‚‚ä¸è¦ã§ã‚ã‚‹ã€‚  
:::

## ãƒˆãƒ¬ãƒ¼ã‚¹ID

[ãƒˆãƒ¬ãƒ¼ã‚¹IDã‚’ã©ã“ã§æ‰•ã„å‡ºã™ã¹ãã‹ | ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ“ãƒªãƒ†ã‚£ | Web APIè¨­è¨ˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](https://future-architect.github.io/arch-guidelines/documents/forWebAPI/web_api_guidelines.html#%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9id%E3%82%92%E3%81%A8%E3%82%99%E3%81%93%E3%81%A6%E3%82%99%E6%89%95%E3%81%84%E5%87%BA%E3%81%99%E3%81%B8%E3%82%99%E3%81%8D%E3%81%8B) ã«è¨˜è¼‰ã—ãŸã¨ãŠã‚Šã€ãªã‚‹ã¹ãä¸Šæµã§ãƒˆãƒ¬ãƒ¼ã‚¹IDã¯æ‰•ã„å‡ºã—ã¦å‡ºåŠ›ã™ã‚‹ã€‚

- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çµ±åˆ¶ã‚’è¡Œãˆã‚‹ã®ã§ã‚ã‚Œã°ã€â‘ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ãƒˆãƒ¬ãƒ¼ã‚¹IDã‚’ç”Ÿæˆã™ã‚‹
- çµ±åˆ¶ãŒç„¡ç†ãªå ´åˆã¯ã€ã‚µãƒ¼ãƒãƒ¼ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ï¼ˆServletFilterã‚„ã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ã‚¿ãƒ¼ã®å±¤ï¼‰ã§ãƒˆãƒ¬ãƒ¼ã‚¹IDã‚’ç™ºç•ªã™ã‚‹

## ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ãƒ­ã‚°

é–‹ç™ºè€…/é‹ç”¨è€…å‘ã‘ã®ã€Œãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã¨é¡ä¼¼ã®æ¦‚å¿µã¨ã—ã¦ã€ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«çŠ¶æ³ã‚’ä¼ãˆã€æ¬¡ã«è¡Œã†ã¹ãã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä¿ƒã™ã“ã¨ã‚’ç›®çš„ã¨ã—ãŸã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãŒå­˜åœ¨ã™ã‚‹ã€‚

æ¨å¥¨ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

- ãƒ­ã‚°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤ºã™ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€ç›®çš„ã¨å¯¾è±¡è€…ãŒç•°ãªã‚‹ãŸã‚ã€å¿…ãšåˆ†é›¢ã—ã¦ç®¡ç†ã™ã‚‹
  - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ã‚’é¿ã‘ã‚‹ãŸã‚ï¼ˆè©³ç´°: [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£](#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£)ç« ï¼‰
  - ä¿å®ˆæ€§ã‚’ä¸Šã’ã‚‹ãŸã‚ï¼ˆãƒ‡ãƒãƒƒã‚°ã®ãŸã‚ã«ãƒ­ã‚°æƒ…å ±ã‚’è¿½åŠ ãƒ»å¤‰æ›´ã—ãŸã„å ´åˆã§ã‚‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ–‡è¨€ã‚’æ°—ã«ã—ãªãã¦ã‚‚æ¸ˆã‚€ã€‚ã¾ãŸãã®é€†ã‚‚ã‚ã‚‹ï¼‰
- ãƒ­ã‚°å‡ºåŠ›ã‚’ã—ã¤ã¤ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã«ã‚¨ãƒ©ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ãã‚Œã‚‰ã‚’ç´ã¥ã‘ã‚‹ãŸã‚ã«ã€ãƒˆãƒ¬ãƒ¼ã‚¹IDã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã‚‚å‡ºåŠ›ã—ã€ç´ã¥ã‘ã‚’å¯èƒ½ã¨ã™ã‚‹
  - ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ã€Œã“ã®IDã®è¡¨ç¤ºã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã—ãŸã€ã¨å•ã„åˆã‚ã›ãŒã‚ã£ãŸéš›ã«ã€ãã®IDã‚’ã‚­ãƒ¼ã«èª¿æŸ»ãŒå¯èƒ½ã¨ãªã‚‹ï¼ˆã©ã®ã‚ˆã†ãªæ“ä½œã‚’ã—ãŸã‹ï¼Ÿ ä½•æ™‚é ƒã§ã™ã‹ï¼Ÿã¨ã„ã£ãŸã‚„ã‚Šå–ã‚Šã‚’æ¸›ã‚‰ã™ã“ã¨ãŒã§ãã‚‹ï¼‰

âœ…ï¸å‡ºåŠ›ä¾‹ï¼ˆé–‹ç™ºè€…å‘ã‘ã®ãƒ­ã‚°ï¼‰

```json
{
  "timestamp": "2025-09-12T14:46:16.234+09:00",
  "severity.text": "ERROR",
  "message": "Error processing payment.",
  "service.name": "payment-service",
  "thread.name": "http-nio-8080-exec-5",
  "logger.name": "com.example.MyPaymentService",
  "error.id": "E-1a2b3c4d",
  "error.code": "PAYMENT-003",
  "exception.type": "com.example.PaymentApiException",
  "exception.message": "Credit card company timeout",
  "exception.stack_trace": "com.example.PaymentApiException: Credit card company timeout\n\tat com.example.MyPaymentService.processPayment(MyPaymentService.java:42)\n\t... (ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãŒç¶šã)"
}
```

âœ…ï¸å‡ºåŠ›ä¾‹ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰

```console
æ±ºæ¸ˆå‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãŠæ‰‹æ•°ã§ã™ãŒã€æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚
è§£æ±ºã—ãªã„å ´åˆã¯ã€ã‚µãƒãƒ¼ãƒˆã¾ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚(ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰:E10222  ãƒˆãƒ¬ãƒ¼ã‚¹ID: E-00112233)
```

## ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ›¸ãæ–¹

ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å˜ä½“ã§ã‚‚ã€ã€Œä½•ãŒãƒ»ãªãœèµ·ããŸã®ã‹ã€ã‚’ç†è§£ã§ãã‚‹ã‚ˆã†ã«æ›¸ãã¨ã€åˆå‹•ã‚’ä¸Šã’ã‚‹ã“ã¨ãŒã§ãã€é‹ç”¨è¦–ç‚¹ã§ã‚‚å„ªã‚Œã¦ã„ã‚‹ã€‚

æ¨å¥¨ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

- å…·ä½“çš„ã‹ã¤ã€ä¸€æ„ã«è§£é‡ˆã§ãã‚‹ã‚ˆã†ã«æ›¸ã
  - âŒï¸: ã€ŒDBã‚¨ãƒ©ãƒ¼ã§ã™ã€ (æ¥ç¶šï¼Ÿã‚¯ã‚¨ãƒªï¼Ÿã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼Ÿ)
  - âœ…ï¸: ã€Œå•†å“ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®INSERTã«å¤±æ•—ã—ã¾ã—ãŸã€‚åŸå› : ä¸»ã‚­ãƒ¼ãŒé‡è¤‡ã—ã¦ã„ã¾ã™ã€‚ productId: 12345ã€
- èª¿æŸ»ã§åˆ‡ã‚Šåˆ†ã‘ã«ä½¿ãˆã‚‹ï¼ˆãƒˆãƒ¬ãƒ¼ã‚¹ã§ãã‚‹æƒ…å ±ï¼‰è­˜åˆ¥å­ã‚’å«ã‚ã‚‹ã“ã¨
  - Javaã§ã¯MDCã€Goã§ã¯contextã«å…¥ã‚Œã¦ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯å´ã§è‡ªå‹•çš„ã«ãƒ­ã‚°ã¸ä»˜ä¸ã™ã‚‹è¨­è¨ˆã«ã™ã‚‹
  - è­˜åˆ¥å­ã®ä¾‹
    - ãƒªã‚¯ã‚¨ã‚¹ãƒˆID / ãƒˆãƒ¬ãƒ¼ã‚¹ID: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å…¥å£ã‹ã‚‰å‡ºå£ã¾ã§ã‚’ç¹‹ãæœ€ã‚‚é‡è¦ãªID
    - ãƒ¦ãƒ¼ã‚¶ãƒ¼ID / ãƒ†ãƒŠãƒ³ãƒˆID: èª°ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§å•é¡ŒãŒèµ·ããŸã®ã‹ã‚’ç‰¹å®š
    - ã‚»ãƒƒã‚·ãƒ§ãƒ³ID: ç‰¹å®šã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã®ä¸€é€£ã®æ“ä½œã‚’è¿½è·¡
    - æ³¨æ–‡ID / å•†å“IDãªã©: ãƒ“ã‚¸ãƒã‚¹ä¸Šé‡è¦ãªID
- äº‹å®Ÿã¨ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†é›¢ã™ã‚‹
  - ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã€Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆäº‹å®Ÿï¼‰ã€ã¨ã€Œå¯å¤‰å€¤ï¼ˆãƒ‡ãƒ¼ã‚¿ï¼‰ã€ã‚’åˆ†é›¢ã™ã‚‹
  - å¯å¤‰å€¤ã¯æ§‹é€ åŒ–ãƒ­ã‚°ã¨ã—ã¦å€‹åˆ¥ã®ã‚­ãƒ¼ã¨ã—ã¦åˆ‡ã‚Šå‡ºã™
  - Goã®slogã‚’ä½¿ã£ãŸä¾‹
    - âŒï¸: logger.Info("ãƒ¦ãƒ¼ã‚¶ãƒ¼ " \+ userId \+ " ã®ã‚«ãƒ¼ãƒˆè¿½åŠ æ™‚ã®åœ¨åº«å¼•å½“ã«å¤±æ•—ã—ã¾ã—ãŸã€‚SKU: " \+ skuId)
    - âŒï¸: logger.Info(â€œã‚«ãƒ¼ãƒˆè¿½åŠ æ™‚ã®åœ¨åº«å¼•å½“ãŒå¤±æ•—ã—ã¾ã—ãŸã€‚ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ " \+ userId \+ "SKU: " \+ skuId+ â€œï¼‰â€)
    - âœ…ï¸: logger.Info("ã‚«ãƒ¼ãƒˆè¿½åŠ æ™‚ã®åœ¨åº«å¼•å½“ãŒå¤±æ•—ã—ã¾ã—ãŸã€‚", "user.id", userId,"sku.cd", skuId)
  - å¯å¤‰å€¤ã¯ã€ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã§ãƒ•ãƒ©ãƒƒãƒˆã«ã‚‚ãŸã›ã‚‹
    - ãƒ­ã‚°åˆ†ææ€§ã‚’ä¸Šã’ã‚‹ãŸã‚ï¼ˆdetailsã«ã™ã‚‹ã¨è¦–èªæ€§ãŒä¸ŠãŒã‚‹ãŒã€ãƒ­ã‚°åŸºç›¤ä¸Šã®ã‚¯ã‚¨ãƒªãŒæ›¸ãã«ããæ€§èƒ½åŠ£åŒ–ã®å¯èƒ½æ€§ã‚‚ã‚ã‚‹ãŸã‚ï¼‰

âœ…ï¸: å¯å¤‰å€¤ã‚’ãƒ•ãƒ©ãƒƒãƒˆã«ã—ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨åˆ†é›¢ã—ãŸä¾‹

```json
{
  "timestamp": "2025-08-26T10:36:17.123+09:00",
  "severity.text": "INFO",
  "message": "ã‚«ãƒ¼ãƒˆè¿½åŠ æ™‚ã®åœ¨åº«å¼•å½“ãŒå¤±æ•—ã—ã¾ã—ãŸã€‚",
  "user.id": "user-456",
  "sku.cd": "ABC-123-XYZ-RED-L"
}
```

âŒï¸: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æœ¬æ–‡ã«å¯å¤‰å€¤ã‚’åŸ‹ã‚è¾¼ã‚“ã ä¾‹

```json
{
  "timestamp": "2025-08-26T10:36:17.123+09:00",
  "severity.text": "INFO",
  "message": "ã‚«ãƒ¼ãƒˆè¿½åŠ æ™‚ã®åœ¨åº«å¼•å½“ãŒå¤±æ•—ã—ã¾ã—ãŸã€‚ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ID:user-456 SKU:ABC-123-XYZ-RED-Lï¼‰"
}
```

âŒï¸: detailsé…ä¸‹ã«ã¾ã¨ã‚ã‚‹ä¾‹

```json
{
  "timestamp": "2025-08-26T10:36:17.123+09:00",
  "severity.text": "INFO",
  "message": "ã‚«ãƒ¼ãƒˆè¿½åŠ æ™‚ã®åœ¨åº«å¼•å½“ãŒå¤±æ•—ã—ã¾ã—ãŸã€‚",
  "details": {
    "user.id": "user-456",
    "sku.cd": "ABC-123-XYZ-RED-L"
  }
}
```

# å‡ºåŠ›ãƒ«ãƒ¼ãƒ«

## ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ­ã‚°å‡ºåŠ›

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã¯ã€åŸºæœ¬çš„ã«ãƒ­ã‚°å‡ºåŠ›ã‚’è¡Œã‚ãªã„ã€‚

- é–‹ç™ºè€…å‘ã‘ã®ãƒ‡ãƒãƒƒã‚°æƒ…å ±ãŒã€ä¸€èˆ¬ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚‚è¦‹ãˆã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚Šã€æƒ…å ±æ¼æ´©ã®ãƒªã‚¹ã‚¯ãŒã‚ã‚‹ãŸã‚
- ãƒ‡ãƒãƒƒã‚°ç”¨ã®consoleãŒæ®‹ã£ã¦ã„ã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰ãŒèª­ã¿ã«ãããªã‚‹ãŸã‚
- ESLintã‚„Biomeã®ãƒ«ãƒ¼ãƒ«ã§consoleã®ä½¿ç”¨ã¯è­¦å‘Šã•ã‚Œã‚‹ãŸã‚ã€ãã®ãƒ«ãƒ¼ãƒ«ã«åˆã‚ã›ã‚‹

ã‚‚ã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚¨ãƒ©ãƒ¼çŠ¶æ³ãªã©åé›†ã—ãŸã„å ´åˆã¯ã€Sentryãªã©ã®ãƒ­ã‚°åŸºç›¤ã‚’å°å…¥ã‚’æ¤œè¨ã™ã‚‹ã“ã¨ã€‚

::: info å‚è€ƒ

- [noConsole | Biome](https://biomejs.dev/linter/rules/no-console/)
- [no-console \- ESLint \- Pluggable JavaScript Linter](https://eslint.org/docs/latest/rules/no-console)

:::

## èµ·å‹•æ™‚ã®ãƒ­ã‚°å‡ºåŠ›

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã®ãƒ­ã‚°å‡ºåŠ›ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ã‚’æŠŠæ¡ã—ã€å•é¡Œã‚’ç´ æ—©ãç‰¹å®šã™ã‚‹ãŸã‚ã«éå¸¸ã«é‡è¦ã§ã‚ã‚‹ã€‚ã€Œä½•ãŒã€ã©ã®ã‚ˆã†ãªè¨­å®šã§ã€æ­£å¸¸ã«èµ·å‹•ã—ãŸã‹ã€ã‚’ä¸€ç›®ã§æŠŠæ¡ã§ãã€å•é¡Œç™ºç”Ÿæ™‚ã®è¿…é€ŸãªåŸå› ç‰¹å®šãŒå¯èƒ½ãªã‚ˆã†ãƒ­ã‚°å‡ºåŠ›ã‚’è¡Œã†ã€‚

æ¨å¥¨ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

- ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«: INFO ã«ã™ã‚‹
- ä»¥ä¸‹ã®é …ç›®ã‚’å‡ºåŠ›ã™ã‚‹

| é …ç›®           | æ¦‚è¦                                                                                                               | ä¾‹                            |
| :------------- | :----------------------------------------------------------------------------------------------------------------- | :---------------------------- |
| ã‚µãƒ¼ãƒ“ã‚¹å     | ã©ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒ­ã‚°ã‹ã‚’æ˜ç¢ºã«ã™ã‚‹ãŸã‚ï¼ˆç‰¹ã«ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ç’°å¢ƒã§é‡è¦ï¼‰                                             | user-api                      |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ± | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¤ºã™ã€‚ãƒ“ãƒ«ãƒ‰æ™‚ã® `git tag` æƒ…å ±ç­‰ã‚’å‡ºåŠ›ã™ã‚‹                                            | v1.2.3                        |
| Gitãƒãƒƒã‚·ãƒ¥    | ãƒ“ãƒ«ãƒ‰æ™‚ã® `git hash` å€¤ã‚’å‡ºåŠ›ã™ã‚‹                                                                                 | da94541                       |
| ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ— | â€œãƒ“ãƒ«ãƒ‰æ™‚â€ ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’JSTã§å‡ºåŠ›ã™ã‚‹ã€‚èµ·å‹•æ™‚ã§ã¯ç„¡ã„ã“ã¨ã«æ³¨æ„                                               | 2025-09-12T14:46:16.234+09:00 |
| å®Ÿè¡Œç’°å¢ƒ       | development, staging, production ã®ã©ã‚Œã§å‹•ã„ã¦ã„ã‚‹ã‹ã‚’åŒºåˆ¥ã™ã‚‹ãŸã‚                                                | production                    |
| ä¸»è¦ãªè¨­å®šå€¤   | æ¥ç¶šå…ˆã®DBãƒ›ã‚¹ãƒˆãªã©ã€å‹•ä½œã«å½±éŸ¿ã™ã‚‹é‡è¦ãªè¨­å®šå€¤ã€‚ âš ï¸æ³¨æ„ï¼šãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚„APIã‚­ãƒ¼ãªã©ã®æ©Ÿå¯†æƒ…å ±ã¯çµ¶å¯¾ã«å‡ºåŠ›ã—ãªã„ã“ã¨ | DB_HOST: prod-db.example.com  |

- èµ·å‹•ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ã‚’è¨˜éŒ²ã™ã‚‹
  - èµ·å‹•ãŒå®Œäº†ã™ã‚‹ã¾ã§ã®ä¸»è¦ãªã‚¹ãƒ†ãƒƒãƒ—ï¼ˆãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ï¼‰ã‚’ãƒ­ã‚°ã«å‡ºåŠ›ã™ã‚‹ã“ã¨ã§ã€ã‚‚ã—é€”ä¸­ã§å¤±æ•—ã—ãŸå ´åˆã«ã©ã®æ®µéšã§å•é¡ŒãŒèµ·ããŸã®ã‹ã‚’ç‰¹å®šãŒã§ãã‚‹ã€‚

::: tip èµ·å‹•ãƒ­ã‚°ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ  
èµ·å‹•ãƒ­ã‚°ã¯å¿…ãšã—ã‚‚ãã®ä»–ã®ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¨ä¸€è‡´ã—ã¦ã„ãªãã¨ã‚‚è‰¯ã„ã€‚é€šå¸¸ã®ãƒ­ã‚°ã¯æ©Ÿæ¢°çš„ãªè§£æã«å‚™ãˆã¦æ§‹é€ åŒ–ã•ã›ã¦ãŠã„ãŸæ–¹ãŒæœ‰åˆ©ã ãŒã€èµ·å‹•ãƒ­ã‚°ã¯ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã‚„éšœå®³ç™ºç”Ÿæ™‚ã®åˆ‡ã‚Šåˆ†ã‘ç­‰ã€é–‹ç™ºè€…ã«ã‚ˆã‚‹ç¢ºèªç”¨é€”ãŒä¸»ã¨ãªã‚‹ã®ã§ã€ã“ã“ã§ã¯è¦–èªæ€§ã‚’å„ªå…ˆã—ã¦ã„ã‚‹ã€‚

ãŸã ã—ã€ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆæ™‚ãªã©å¤§é‡ã«èµ·å‹•ãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œã‚‹ã‚±ãƒ¼ã‚¹ã§ã¯ãƒã‚¤ã‚ºã¨ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ã€ãã†ã„ã£ãŸå ´åˆã¯å®Ÿè¡Œç’°å¢ƒã«ã‚ˆã£ã¦å‡ºåŠ›æœ‰ç„¡ã‚’åˆ‡ã‚Šå¤‰ãˆã‚‹ã“ã¨ã‚’æ¤œè¨ã™ã‚‹ã€‚  
:::

::: tip ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã®ãƒã‚¤ãƒ³ãƒ‰  
ãƒãƒŠãƒ¼å†…ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ãªã©ã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹ã¨ã€æ›´æ–°ã‚’å¿˜ã‚ŒãŒã¡ã«ãªã‚Šã€å®Ÿéš›ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ä¹–é›¢ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚ãƒ“ãƒ«ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã§é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã‚€ãªã©ã§å¯èƒ½ãªé™ã‚Šè‡ªå‹•åŒ–ã™ã‚‹ã“ã¨ã‚’æ¤œè¨ã™ã‚‹ã€‚  
:::

```console
  _   _   _   _   _   _
 / \ / \ / \ / \ / \ / \
( U | S | E | R | A | P | I )
 \_/ \_/ \_/ \_/ \_/ \_/
 ==================================================
 Service: UserAPI
 Ver: v1.5.2
 GitHash: da94541
 Timestamp: "2025-09-12T14:36:16.234+09:00"
 ENV: production
 ==================================================

{
  "timestamp": "2025-09-12T14:46:16.234+09:00",
  "severity.text": "INFO",
  "message": "Application startup sequence initiated.",
}
{
  "timestamp": "2025-09-12T14:46:16.235+09:00",
  "severity.text": "INFO",
  "message": "Configuration loaded successfully.",
}
{
  "timestamp": "2025-09-12T14:46:16.236+09:00",
  "severity.text": "INFO",
  "message": "Config: {"key": "value"...}",
}
{
  "timestamp": "2025-09-12T14:46:16.237+09:00",
  "severity.text": "INFO",
  "message": "Database connection established.",
}
{
  "timestamp": "2025-09-12T14:46:16.238+09:00",
  "severity.text": "INFO",
  "message": "Server listening on http://0.0.0.0:8080",
}
```

## Web APIã®ãƒ­ã‚°å‡ºåŠ›

Web APIã‚¢ã‚¯ã‚»ã‚¹ã«å¯¾ã—ã¦é©åˆ‡ã«ãƒ­ã‚°å‡ºåŠ›ã™ã‚‹ã“ã¨ã§ã€ä¸å…·åˆæ¤œçŸ¥ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®èª¿æŸ»ã€æ€§èƒ½åˆ†æãªã©ã«å½¹ç«‹ã¦ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

### ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°

ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã«å¯¾ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®è¨˜éŒ²ã§ã‚ã‚‹ã€‚å‡ºåŠ›ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¯ æ¨å¥¨é †ã«3ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚‹ã€‚

1. ï¼ˆæ¨å¥¨ï¼‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ä¸¡æ–¹ã§å‡ºåŠ›ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ä¸¡æ–¹ã‚’å‡ºã™ã“ã¨ã§ã€èª¿æŸ»æ€§ã‚’ä¸Šã’ã‚‹ã€‚ãƒ­ã‚°é‡ã¯å€ã«ãªã‚‹ãŒã€ä¿å®ˆé‹ç”¨æ€§ã‚’é«˜ã‚ã‚‹ã“ã¨ã‚’å„ªå…ˆã™ã‚‹ãŸã‚ï¼‰
1. ãƒ¬ã‚¹ãƒãƒ³ã‚¹å¾Œã«å‡ºåŠ›ï¼ˆå‡¦ç†æ™‚é–“ã‚„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å‡ºåŠ›ã§ãã‚‹ãŸã‚ï¼‰
1. ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå±Šã„ãŸç¬é–“ã«å‡ºåŠ›

::: tip ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã¯å‡ºåŠ›ã•ã›ãªã„
ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã«å¯¾ã™ã‚‹ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã¯é™¤å¤–ã™ã‚‹ã‚ˆã†ãªåˆ†å²ã‚’å…¥ã‚ŒãŸæ–¹ãŒè‰¯ã„ã€‚ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯APIã¯ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ãªã©ã‚·ã‚¹ãƒ†ãƒ å†…éƒ¨å´ã§åˆ©ç”¨ã•ã‚Œã‚‹ãŸã‚ã€ãƒ­ã‚°ã‚’å‡ºåŠ›ã™ã‚‹ã¨èª¿æŸ»åˆ†æã®å¦¨ã’ã«ãªã‚‹ã—ã€ä½™è¨ˆãªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¢ã‚¦ãƒˆã«ã‚‚ç¹‹ãŒã‚‹ãŸã‚ã§ã‚ã‚‹ã€‚  
:::

::: tip OPTIONSã®ãƒ­ã‚°ã¯å‡ºã™ã¹ãã‹ï¼Ÿ  
Web APIè¨­è¨ˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ > [æ©Ÿèƒ½é…ç½®](/documents/forWebAPI/web_api_guidelines.html#æ©Ÿèƒ½é…ç½®aws)ã§ã¯ã€CORSå¯¾å¿œã®ãŸã‚ã®OPTIONSãƒ¡ã‚½ãƒƒãƒ‰ã¯APIã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ãªã©ã§å¯¾å¿œã•ã›ã‚‹ã“ã¨ãŒæ¨å¥¨ã§ã‚ã‚‹ã€‚ã‚‚ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã§OPTIONSãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã™ã‚‹å ´åˆã¯ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç›£è¦–ã«å½¹ç«‹ã¤ãŸã‚ã€ç‰¹ã«HTTPãƒ¡ã‚½ãƒƒãƒ‰ã§çµã‚‰ãšãã®ã¾ã¾ãƒ­ã‚°ã‚’å‡ºã—ã¦ãŠãæ–¹ãŒè‰¯ã„ã€‚  
:::

::: info å‚è€ƒ
[OWASP/CheatSheetSeries](https://github.com/OWASP/CheatSheetSeries)ã®[cheatsheets/Logging_Cheat_Sheet.md](https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Logging_Cheat_Sheet.md)
:::

### ãƒ­ã‚°é …ç›®

ã€Œæ¨å¥¨ã™ã‚‹ã‚­ãƒ¼åç§°ã€ã§å®šç¾©ã—ãŸå…±é€šã‚¹ã‚­ãƒ¼ãƒã«åŠ ãˆã€ä»¥ä¸‹ã®é …ç›®ã‚’å‡ºåŠ›ã™ã‚‹ã€‚

| é …ç›®             | é …ç›®                         | è¦æ±‚æ™‚ | å¿œç­”æ™‚ | å‚™è€ƒ                                                                                                                 |
| :--------------- | :--------------------------- | :----- | :----- | :------------------------------------------------------------------------------------------------------------------- |
| ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—   | timestamp                    | âœ…ï¸     | âœ…ï¸     | ISO 8601å½¢å¼ã§ãƒŸãƒªç§’ã¾ã§ä¿æŒã™ã‚‹ã€‚ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã¯UTC 2024-10-12T11:23:01.123Z ã¾ãŸã¯JST 2024-10-12T20:23:01.123+09:00 |
| ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«       | severity.tex                 | âœ…ï¸     | âœ…ï¸     | infoå›ºå®šã¾ãŸã¯ã€è¦æ±‚æ™‚ã‚’debugãƒ»å¿œç­”æ™‚ã«infoã«ã—ã¦ã‚‚è‰¯ã„                                                              |
| ãƒªã‚¯ã‚¨ã‚¹ãƒˆID     | request.id                   | âœ…ï¸     | âœ…ï¸     | ãƒˆãƒ¬ãƒ¼ã‚¹ç”¨ã®IDã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯ãã‚Œã‚’ã€å­˜åœ¨ã—ãªã‘ã‚Œã°ã‚µãƒ¼ãƒå´ã§æ¡ç•ªã—ãŸå€¤ã‚’å‡ºåŠ›                   |
| URLãƒ‘ã‚¹          | url.path                     | âœ…ï¸     | âœ…ï¸     | ç›¸å¯¾ãƒ‘ã‚¹ã€‚ `/api/v1/users`                                                                                           |
| HTTPãƒ¡ã‚½ãƒƒãƒ‰     | http.request.method          | âœ…ï¸     | âœ…ï¸     | HEAD,GET,POST,PUT,PATCH,DELETE                                                                                       |
| é€ä¿¡å…ƒIPã‚¢ãƒ‰ãƒ¬ã‚¹ | client.address               | â“ï¸     | â“ï¸     | ãƒ‘ãƒ–ãƒªãƒƒã‚¯APIã®å ´åˆã€å€‹äººæƒ…å ±ç‰¹å®šã«ç¹‹ãŒã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€å‡ºåŠ›å¯å¦ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åŸºæº–ã«å¾“ã†            |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ID       | user_id                      | â“ï¸     | â“ï¸     | ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®å ´åˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å‡ºåŠ›ã™ã‚‹                                                                             |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ | http.response.status_code    | ãƒ¼     | âœ…ï¸     | HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰                                                                                                 |
| å‡¦ç†æ™‚é–“         | http.server.request.duration | ãƒ¼     | âœ…ï¸     | ãƒŸãƒªç§’ã‚’æ¨å¥¨                                                                                                         |
| User Agent       | user_agent.original          | âœ…ï¸     | âœ…ï¸     | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç‰¹å®šã«åˆ©ç”¨ã™ã‚‹ã€‚                                                                                       |

## ãƒãƒƒãƒå®Ÿè¡Œæ™‚ã®ãƒ­ã‚°å‡ºåŠ›

ãƒãƒƒãƒå‡¦ç†ã§ã‚‚é©åˆ‡ãªãƒ­ã‚°ã‚’å‡ºåŠ›ã™ã‚‹ã“ã¨ã§ã€ä½•ã‹èª²é¡ŒãŒç”Ÿã˜ãŸéš›ã«è§£æã®æ‰‹ãŒã‹ã‚Šã¨ãªã‚Šã€ä¿å®ˆé‹ç”¨æ™‚ã‚³ã‚¹ãƒˆã‚’ä½æ¸›ã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

æ¨å¥¨ã¯ä»¥ä¸‹ã€‚

- èµ·å‹•ãƒ»çµ‚äº†ã¯ãƒ­ã‚°å‡ºåŠ›ã™ã‚‹
  - æ©Ÿèƒ½IDã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€å®Ÿè¡Œæ™‚é–“ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã©æ±ºã‚ã‚‰ã‚ŒãŸé …ç›®ã‚’å‡ºåŠ›ã™ã‚‹ã“ã¨ã§ãƒˆãƒ¬ãƒ¼ã‚¹ã—ã‚„ã™ãã™ã‚‹
  - ä½•ã‹ã—ã‚‰ã®å…±é€šæ©Ÿèƒ½å´ã§è¨­å®šã§ãã‚‹ã¨è‰¯ã„
- å‡¦ç†ä»¶æ•°ã‚’ãƒ­ã‚°å‡ºåŠ›ã™ã‚‹
  - ç‰¹ã«ã€‚0ä»¶ã§ã‚¹ã‚­ãƒƒãƒ—ã—ãŸã®ã§ã‚ã‚Œã°ã€ãã®æ—¨ã‚‚INFOãƒ­ã‚°ã«å‡ºã™
  - çµåˆãƒ†ã‚¹ãƒˆæ™‚ãªã©ã§ã€å‡ºåŠ›å…ˆã®DBãƒ†ãƒ¼ãƒ–ãƒ«ã«æ›¸ãè¾¼ã¿ãŒã‚¼ãƒ­ä»¶ã ã£ãŸå ´åˆã«ã€èª¿æŸ»ã—ãŸã„ã“ã¨ã¯æ„å¤–ã¨å¤šã„
- é€²è¡Œä¸­ã®ãƒ­ã‚°
  - å¤§é‡ä»¶æ•°ã‚’ãƒ«ãƒ¼ãƒ—ã§å‡¦ç†ã™ã‚‹å ´åˆã¯é€²è¡ŒçŠ¶æ³ãŒåˆ†ã‹ã‚‹ã‚ˆã†ã«ã€ä¾‹ãˆã°1ä¸‡ä»¶ã”ã¨ã«ãƒ­ã‚°ãŒå‡ºã™ã¨è‰¯ã„ï¼ˆå…¥åŠ›ã®å‡¦ç†ä»¶æ•°ã¨åˆã‚ã›ã‚‹ã¨ã€å¤§ä½“ã®çµ‚äº†æ™‚é–“ã®è¦‹è¾¼ã¿ãŒç«‹ã¦ã‚‰ã‚Œã‚‹ãŸã‚ï¼‰
  - ãƒãƒƒãƒå‡¦ç†ãŒãƒ­ãƒƒã‚¯å¾…ã¡ãªã©ä½•ã‹ã—ã‚‰ã®ç†ç”±ã§ãƒãƒ³ã‚°ã—ã¦ã—ã¾ã£ãŸã®ã‹ã€é€²ã‚“ã§ã„ã‚‹ã‹è¦‹æ¥µã‚ãŸã„å ´åˆãŒã‚ã‚‹
- SQLå®Ÿè¡Œãƒ­ã‚°ã«ã¤ã„ã¦
  - twoway-sql ã®å ´åˆã¯ã€ç”Ÿæˆå¾Œã®SQLã«ãŸã„ã—ã¦ã€€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ã¦å‡ºåŠ›ã™ã‚‹ã“ã¨ãŒæœ›ã¾ã—ã„
- ãƒ«ãƒ¼ãƒ—å‡¦ç†ã§ã®ãƒ­ã‚°å‡ºåŠ›ã¯ã‚»ãƒ¼ãƒ–ã™ã‚‹
  - Amazon CloudWatch Logsãªã©ã¯æ€ã„ã®å¤–ã‚³ã‚¹ãƒˆãŒé«˜ã„ãŸã‚ã€ä¾‹ãˆã°æ•°åƒä»¶ã‚ªãƒ¼ãƒ€ãƒ¼ã‹ã‚‰1è¡Œãšã¤ãƒ­ã‚°å‡ºåŠ›ã™ã‚‹ã¨ã€æƒ³å®šå¤–ã®è²»ç”¨ã¨ãªã‚‹
  - ãƒ«ãƒ¼ãƒ—å†…ã§ã¯ãªãå¤–ã«ã™ã‚‹ã‹ã€1ä¸‡ä»¶ã”ã¨ã«ãƒ­ã‚°å‡ºåŠ›ã™ã‚‹ãªã©å·¥å¤«ã‚’ã™ã‚‹

å‡ºåŠ›ä¾‹:

```json
// é–‹å§‹æ™‚
{
  "timestamp": "...",
  "severity.text": "INFO",
  "message": "æœˆæ¬¡é›†è¨ˆãƒãƒƒãƒã‚’é–‹å§‹ã—ã¾ã™",
  "batch.job_id": "monthly-aggregate",
  "batch.params": {"target_month": "2025-09"}
}

// é€²è¡Œä¸­ï¼ˆã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ï¼‰
{
  "timestamp": "...",
  "severity.text": "INFO",
  "message": "é›†è¨ˆå‡¦ç†é€²è¡Œä¸­: 10000 / 50000 ä»¶å®Œäº† (20%)"
}

// çµ‚äº†æ™‚
{
  "timestamp": "...",
  "severity.text": "INFO",
  "message": "æœˆæ¬¡é›†è¨ˆãƒãƒƒãƒã‚’æ­£å¸¸çµ‚äº†ã—ã¾ã—ãŸ",
  "batch.result": "success",
  "batch.stats": {
    "total": 50000,
    "success": 49998,
    "failed": 2,
    "skipped": 0
  },
  "duration_ms": 120500
}
```

## éæ­£è¦åŒ–

åˆ©ç”¨è¦ç´„ãªã©ã«æ˜è¨˜ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨åˆæ„ã‚’å–ã£ãŸä¸Šã§ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’åˆ†æã™ã‚‹å ´åˆã€åˆ†æã«å¿…è¦ãªãƒ¦ãƒ¼ã‚¶ãƒ¼å±æ€§ã‚’æŒ¯ã‚Šä¸‹ã‚ã™ã¨ã„ã†éæ­£è¦åŒ–ã‚’è¡Œã†ã“ã¨ã¯ã‚ˆãã‚ã‚‹ã€‚ä¾‹ãˆã°ã€ä¼šå“¡ãƒ©ãƒ³ã‚¯ï¼ˆé€šå¸¸ä¼šå“¡ã€ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ï¼‰ãªã©ã®å±æ€§ã¯ãƒã‚¹ã‚¿ã‹ã‚‰å¼•ãå½“ã¦ã‚‹ã“ã¨ãŒã§ãã‚‹ãŒã€åˆ†ææ™‚ã®ã‚³ã‚¹ãƒˆãŒä¸ŠãŒã‚‹ãŸã‚ã€æŒ¯ã‚Šä¸‹ã‚ã™ã“ã¨ãŒæœ›ã¾ã—ã„ã®ã§ã‚ã‚Œã°ã€äºˆã‚ãƒ­ã‚°é …ç›®ã¨ã—ã¦å‡ºåŠ›ã™ã‚‹ã“ã¨ãŒæœ›ã¾ã—ã„ã€‚

## æš—é»™çš„ãªãƒ­ã‚°é …ç›®ãƒ»æ˜ç¤ºçš„ãªãƒ­ã‚°é …ç›®

å¤šãã®ãƒ­ã‚°å‡ºåŠ›ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ã€ãƒ­ã‚¬ãƒ¼ç”Ÿæˆæ™‚ã«é …ç›®ã‚’è¨­å®šã—ãŸã‚Šã€è¦ªã®ãƒ­ã‚¬ãƒ¼ã«å¯¾ã—ã¦æƒ…å ±ã‚’ä»˜ä¸ã—ãŸå­ãƒ­ã‚¬ãƒ¼ã‚’ä½œæˆã§ãã‚‹ã“ã¨ãŒå¤šã„ã€‚ã¾ãŸæ—¥ä»˜ãªã©ã®ã‚ˆã†ã«ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã‚’ä¸ãˆãªãã¦ã‚‚æ©Ÿæ¢°çš„ã«æ±ºå®šã§ãã‚‹é …ç›®ã‚‚ã‚ã£ãŸã‚Šãƒ‡ãƒ¼ã‚¿ã”ã¨ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã¯æ§˜ã€…ã§ã‚ã‚‹ã€‚

æ¨å¥¨ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

- ä¸‹è¡¨ã®ã‚ˆã†ãªã€ãƒ­ã‚°é …ç›®ä¸€è¦§ã‚’ä½œæˆã™ã‚‹
  - ã“ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚’æ˜è¨˜ã™ã‚‹
  - å…±é€šå‡¦ç†ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚„ã€åˆ©ç”¨ã™ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ç­‰ã§æš—é»™çš„ã«å‡ºåŠ›ã™ã‚‹ã‚‚ã®ã¨ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºè€…ãŒæ˜ç¤ºçš„ã«å‡ºåŠ›ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã‚‚ã®ã‚’æ˜ç¢ºã«ã™ã‚‹

| å‡ºåŠ›å ´æ‰€         | ãƒˆãƒªã‚¬ãƒ¼             | é …ç›®ç¨®åˆ¥             | é …ç›®ä¾‹                                                                                                         | è£œè¶³èª¬æ˜                                                                                                           |
| :--------------- | :------------------- | :------------------- | :------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------- |
| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯   | ãƒªã‚¯ã‚¨ã‚¹ãƒˆå˜ä½ã§å‡ºåŠ› | HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ       | HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€ãƒ‘ã‚¹ã€å‡¦ç†æ™‚é–“ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆå…ƒIP                                                                 | Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãªã©ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚’é€šã˜ã¦è‡ªå‹•çš„ã«è¨˜éŒ²ã™ã‚‹æƒ…å ±                                  |
|                  |                      | DBã‚¢ã‚¯ã‚»ã‚¹           | SQLã‚¯ã‚¨ãƒªãªã©                                                                                                  |                                                                                                                    |
|                  | ä¾‹å¤–ç™ºç”Ÿæ™‚           | ä¾‹å¤–                 | ä¾‹å¤–ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«                                                                                     | try/catchã§æ‹¾ã£ãŸä¾‹å¤–ã¯ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’æ±ºå®š                                                            |
| ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ | ã‚¢ãƒ—ãƒªå‘¼ã³å‡ºã—       | ãƒ­ã‚¬ãƒ¼å‡ºåŠ›é …ç›®       | ãƒ•ã‚¡ã‚¤ãƒ«åã€è¡Œç•ªå·ãªã©                                                                                         | ãƒ­ã‚°å‡ºåŠ›ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãªã©ã‹ã‚‰è‡ªå‹•çš„ã«å–å¾—ã™ã‚‹æƒ…å ±                                                   |
|                  |                      | ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè¨­å®šé …ç›® | ãƒ»èµ·å‹•æ™‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€ç’°å¢ƒå¤‰æ•°ãªã©<br> ãƒ»ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ID<br> ãƒ»ãƒˆãƒ¬ãƒ¼ã‚¹IDã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ID | å‡¦ç†ã®é–‹å§‹ç‚¹ï¼ˆAPèµ·å‹•æ™‚ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆå—ä»˜æ™‚ãªã©ï¼‰ã§è¨­å®šã•ã‚Œã€MDCã‚„Contextã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç­‰ã§å¾Œç¶šã®å‡¦ç†ã«å¼•ãç¶™ãŒã‚Œã‚‹æƒ…å ± |
|                  |                      | æš—é»™çš„è¨­å®šé …ç›®       | ã‚¯ãƒ©ã‚¹åï¼ˆãƒ­ã‚¬ãƒ¼åï¼‰ãªã©                                                                                       | ãƒ­ã‚¬ãƒ¼åˆæœŸåŒ–æ™‚ã«æŒ‡å®š                                                                                               |
|                  |                      | æ˜ç¤ºçš„å‡ºåŠ›é …ç›®       | ãƒ»ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰<br> ãƒ»å‡¦ç†ã®çŠ¶æ³ã€ç‰¹å®šã®å¤‰æ•°ã‚„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã©                                  | é–‹ç™ºè€…ãŒå€‹åˆ¥ã«ãƒ­ã‚°å†…å®¹ã‚’å®Ÿè£…                                                                                       |
|                  |                      |                      | ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«                                                                                                     | log.error() ã¨ã„ã†ã‚ˆã†ã«ã€æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹å ´åˆ                                                                     |

# å›½éš›åŒ–å¯¾å¿œ/è‹±èªã®å¯¾å¿œæ˜¯é

é–‹ç™ºã€ä¿å®ˆé‹ç”¨ã€SREã€ã‚µãƒãƒ¼ãƒˆãªã©ã®ä¸€éƒ¨ãŒã‚°ãƒ­ãƒ¼ãƒãƒ«ã§ä½“åˆ¶ãŒçµ„ã¾ã‚Œã‚‹å ´åˆã¯ã€è‹±èªã§ã®ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åŒ–ãŒå¿…è¦ã«ãªã‚‹ã€‚

- æ¨å¥¨
  - ã‚‚ã—ã€å›½éš›åŒ–å¯¾å¿œãŒå¿…è¦ãªå ´åˆã€åŸå‰‡ã€è‹±èªã®å¯¾å¿œã¨ã™ã‚‹ï¼ˆæ—¥æœ¬èªã§ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡ºåŠ›ã¯è¡Œã‚ãªã„ï¼‰
    - æ—¥æœ¬èªã‚„ãã®ä»–å„å›½ã®è¨€èªã§ã®ãƒ­ã‚°å‡ºåŠ›ã¯è¡Œã‚ãªã„
    - ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç®¡ç†ã®SSoTï¼ˆSingle Source of Truth: ä¿¡é ¼ã§ãã‚‹å”¯ä¸€ã®æƒ…å ±æºï¼‰ç®¡ç†ã®ãŸã‚
  - ãƒ­ã‚°ã”ã¨ã«ã€é‹ç”¨ãŒä¸€æ„ã¨ãªã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰ã‚’ä»˜ä¸ã™ã‚‹
    - ãã‚Œã«ç´ã¥ãé‹ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã¯ã€å„å›½æ‹ ç‚¹ã”ã¨ã«ä½œæˆã•ã›ã‚‹ãªã©ã¯ã€çŠ¶æ³ã«å¿œã˜ã¦å®Ÿæ–½ã™ã‚‹

âœ…ï¸å‡ºåŠ›ä¾‹ï¼ˆè‹±èªã§ã®å‡ºåŠ›ï¼‰

```json
{
  "timestamp": "2025-08-26T11:45:10.880+09:00",
  "severity.text": "WARN",
  "message.code": "BIZ-W-1001",
  "message": "Inventory update failed due to a data conflict (optimistic lock). Please retry the operation.",
  "process.name": "inventory_allocation",
  "order.id": "order-67890",
  "product.id": "product-ABC-001",
  "requested.quantity": 5,
  "current.version": 12,
  "attempted.version": 11
}
```

âŒï¸å‡ºåŠ›ä¾‹ï¼ˆmessageã€message_jpã‚’è¨­ã‘ã‚‹ã“ã¨ã§ã€è‹±èªãƒ»æ—¥æœ¬èªã®2ç¨®åˆ¥ã§å‡ºåŠ›ã€‚å†—é•·ã§ãƒ­ã‚°ã‚µã‚¤ã‚ºã®è‚¥å¤§åŒ–ã‚’æ‹›ãã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç®¡ç†ã®ä¿å®ˆæ€§ã‚‚ä½ä¸‹ï¼‰

```json
{
  "timestamp": "2025-08-26T11:45:10.880+09:00",
  "severity.text": "WARN",
  "message.code": "BIZ-W-1001",
  "message": "Inventory update failed due to a data conflict (optimistic lock). Please retry the operation.",
  "process.name": "inventory_allocation",
  "order.id": "order-67890",
  "product.id": "product-ABC-001",
  "requested.quantity": 5,
  "current.version": 12,
  "attempted.version": 11
}
```

# ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†

ç‰¹ã«WARNãƒ¬ãƒ™ãƒ«ä»¥ä¸Šã®ãƒ­ã‚°ã¯ã€æ¥­å‹™ãƒ»ã‚·ã‚¹ãƒ†ãƒ å¯¾å¿œãŒå¿…è¦ã¨è€ƒãˆã‚‰ã‚Œã‚‹ãŸã‚ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ä¸€å…ƒçš„ã«ç®¡ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãã‚Œãã‚Œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰ã«ç´ã¥ãã€ä¸€æ„ãªé‹ç”¨ãƒ•ãƒ­ãƒ¼ãŒå®šç¾©ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

ä¸‹è¨˜ã«ä¾‹ã‚’ç¤ºã™ã€‚é‹ç”¨å®šç¾©ã¯ã€Œé‹ç”¨ä¸€è¦§ã€ãƒ»ã€Œé‹ç”¨æ‰‹é †æ›¸ã€ã¨ã—ã¦åˆ¥ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«è¨˜è¼‰ã™ã‚‹ã“ã¨ã‚‚å¤šã„ã€‚

| åˆ†é¡     | é …ç›®                         | å¿…é ˆ | å†…å®¹                                                 | ä¾‹                                                                                                    |
| :------- | :--------------------------- | :--- | :--------------------------------------------------- | :---------------------------------------------------------------------------------------------------- |
| å‡ºåŠ›é …ç›® | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ¼ãƒ‰             | âœ…ï¸   | ä¸€æ„ãªIDã€‚å‘½åè¦å‰‡ã‚’è¨­ã‘ã‚‹ã¹ã                       | AUTH-LOGIN-001                                                                                        |
|          | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸                   | âœ…ï¸   | ä½•ãŒèµ·ããŸã‹ã‚’ä¸€è¡Œã§ç°¡æ½”ã«èª¬æ˜                       | ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã®å¤±æ•—                                                                                    |
|          | å¯å¤‰å€¤                       |      | å¯å¤‰å€¤                                               | userID, itemID, ColorCD, SizeCD                                                                       |
|          | ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |      | (ã‚‚ã—ã‚ã‚Œã°) è¨­å®šã™ã‚‹                                | ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼IDã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€                                                      |
|          | ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«                   | âœ…ï¸   | ERROR, WARN, INFO ã®ã„ãšã‚Œã‹                         | WARN                                                                                                  |
|          | é€šçŸ¥ãƒ•ãƒ©ã‚°                   |      | ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã¨ã¯åˆ¥ã«é€šçŸ¥æœ‰ç„¡ã‚’åˆ¶å¾¡ã—ãŸã„å ´åˆã«è¨­å®šã™ã‚‹ | true / false                                                                                          |
| é‹ç”¨å®šç¾© | ç™ºç”ŸåŸå›                      | âœ…ï¸   | ã“ã®äº‹è±¡ãŒç™ºç”Ÿã™ã‚‹ä¸»ãªåŸå› ã‚„ç™ºç”Ÿæ¡ä»¶ã‚’åˆ—æŒ™           | 1\. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å…¥åŠ›ãƒŸã‚¹<br> 2\. å­˜åœ¨ã—ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã®æŒ‡å®š                                           |
|          | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³                   | âœ…ï¸   | é‹ç”¨è€…ãŒå–ã‚‹ã¹ãå¯¾å¿œã‚„èª¿æŸ»ã‚’è¨˜è¼‰                     | ãƒ»é–¢é€£ãƒ­ã‚°ã‹ã‚‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆå…ƒã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¢ºèª<br> ãƒ»çŸ­æ™‚é–“ã§ã®å¤šç™ºã¯ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã®å¯èƒ½æ€§ã‚’ç–‘ã† |

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

æ¨å¥¨ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

- æ©Ÿå¯†æƒ…å ±ã‚’ãƒ­ã‚°å‡ºåŠ›ã—ãªã„ã€‚ã©ã†ã—ã¦ã‚‚å¿…è¦ãªå ´åˆã¯ãƒã‚¹ã‚­ãƒ³ã‚°ã™ã‚‹
  - ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€APIã‚­ãƒ¼ã€ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ç•ªå·ã€å€‹äººæƒ…å ±ï¼ˆPIIï¼‰ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåé›†ã«åŒæ„ã—ã¦ã„ãªã„æƒ…å ±ï¼ˆGDPRï¼‰
    - èª¤ã£ã¦å‡ºåŠ›ã•ã‚Œãªã„ã‚ˆã†ã«ã€ãƒ­ã‚°å‡ºåŠ›ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯å´ã§ã‚‚ãƒã‚¹ã‚­ãƒ³ã‚°ã‚„ã‚ªãƒŸãƒƒãƒˆã™ã‚‹ã‚ˆã†ãªä½œã‚Šè¾¼ã¿ã‚’è¡Œã£ã¦ãŠã
    - æ©Ÿå¯†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’é™¤å¤–ã—ãŸã€Javaã§ã„ã†toString()ãƒ¡ã‚½ãƒƒãƒ‰ã‚„DTOï¼ˆæ§‹é€ ä½“ãªã©ï¼‰ã‚’ä½œã£ã¦ãŠã
- ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
  - ãƒ­ã‚°ã®ä¸æ­£ãªæ”¹ã–ã‚“ã‚’é˜²ããŸã‚ã€ä¸€åº¦æ›¸ãè¾¼ã¾ã‚ŒãŸã‚‰å¤‰æ›´ã€å‰Šé™¤ã§ããªã„ã‚ˆã†ãªIAMãƒ­ãƒ¼ãƒ«è¨­å®šã‚’è¡Œã†
  - é–²è¦§åˆ¶å¾¡ã‚‚ã€å¿…è¦ãªãƒ¡ãƒ³ãƒãƒ¼ã®ã¿ã«çµã‚‹ã‚ˆã†ã«ã™ã‚‹
- ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ­ã‚°ã¨é–‹ç™ºè€…å‘ã‘ãƒ­ã‚°ã¯åˆ†é›¢ã™ã‚‹
  - ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚„ã€å¤–éƒ¨APIã€DBã®å‡ºåŠ›ã™ã‚‹ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆ`SQLException: Connection refused for user 'root'@'db-host-internal'`ï¼‰ãªã©ã¯æ”»æ’ƒã®ãƒ’ãƒ³ãƒˆã«ãªã‚‹ãŸã‚
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã®ç”»é¢ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªå†…å®¹ã‚’è¡¨ç¤ºã—ã€é–‹ç™ºè€…å‘ã‘ã®è©³ç´°ãªå†…å®¹ã¯ãƒ­ã‚°ã«è¡¨ç¤ºã™ã‚‹æ–¹é‡ã¨ã™ã‚‹

# æ€§èƒ½

æ¨å¥¨ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

- éåŒæœŸãƒ­ã‚®ãƒ³ã‚°
  - Javaã§ã¯ã€ **SLF4J \+ Logback** ã®çµ„ã¿åˆã‚ã›ã‹ã¤ã€AsyncAppender ã‚’æ´»ç”¨ã™ã‚‹
  - Goã®ãƒ­ã‚®ãƒ³ã‚°ã¯éå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ã§æ€§èƒ½ãŒè‰¯ã„ãŸã‚ã€éåŒæœŸãƒ­ã‚®ãƒ³ã‚°ã¯åˆ©ç”¨ã—ãªãã¦ã‚‚è‰¯ã„
  - AsyncAppender ã¯ã€ãƒ­ã‚°ã‚¤ãƒ™ãƒ³ãƒˆã‚’ä¸€æ—¦ãƒ¡ãƒ¢ãƒªä¸Šã®ã‚­ãƒ¥ãƒ¼ã«æ ¼ç´ã—ã€åˆ¥ã®ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚¹ãƒ¬ãƒƒãƒ‰ãŒã‚­ãƒ¥ãƒ¼ã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆã‚’å–ã‚Šå‡ºã—ãƒ­ã‚°å‡ºåŠ›ã™ã‚‹
  - ãƒ—ãƒ­ã‚»ã‚¹éšœå®³æ™‚ã®ãƒ­ã‚°æ¬ æã«å‚™ãˆã€JVMã®ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ãƒ•ãƒƒã‚¯ã§ã‚­ãƒ¥ãƒ¼å†…ã®ãƒ­ã‚°ã‚’ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã•ã›ã‚‹è¨­å®šã‚’è¿½åŠ ã™ã‚‹
  - ã‚­ãƒ¥ãƒ¼ãŒæº¢ã‚ŒãŸæ™‚ã®å¯¾å¿œã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ã•ã›ã‚‹ã€‚ãƒ­ã‚°ã‚’ç ´æ£„ã•ã›ã‚‹è¨­å®šã«ã¯ã—ãªã„
- é…å»¶è©•ä¾¡ã®æ´»ç”¨
  - SLF4Jåˆ©ç”¨ã‹ã¤ã€ä»˜åŠ é …ç›®ã‚’ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«åŸ‹ã‚è¾¼ã‚€å ´åˆã€ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ ({}) ã‚’ä½¿ç”¨ã—ã€ãã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ãŒå‡ºåŠ›å¯¾è±¡ã§ãªã„å ´åˆã€å¼•æ•°ã®æ–‡å­—åˆ—åŒ–ãªã©ã®å‡¦ç†è‡ªä½“ã‚’ãªãã™
    - âœ…ï¸è‰¯ã„ä¾‹: `log.debug("Processing user data: {}", userObject);`
    - âŒï¸æ‚ªã„ä¾‹: `log.debug("Processing user data: " + userObject.toString());`
  - Pythonã®loggingãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã€fæ–‡å­—åˆ—ã§ã¯ãªãã€%å½¢å¼ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ãã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ãŒå‡ºåŠ›å¯¾è±¡ã§ãªã„å ´åˆã®å¼•æ•°ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å‡¦ç†ã‚’é˜²ã
    - âœ…ï¸ è‰¯ã„ä¾‹: `logging.debug("Processing user data: %s", user_object)`
    - âŒï¸ æ‚ªã„ä¾‹: `logging.debug(f"Processing user data: {user_object}")`
  - æ§‹é€ åŒ–ãƒ­ã‚°ã®å ´åˆã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã§ toString() ãªã©ã‚’å‘¼ã³å‡ºã•ãšã€ãƒ­ã‚¬ãƒ¼å´ã«ä»»ã›ã‚‹
    - æœ¬å½“ã«ãƒ­ã‚°å‡ºåŠ›ã•ã‚Œã‚‹å ´åˆã«é™ã‚Šã€ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã‚’é™å®šã§ãã‚‹
- ãƒ­ã‚°å‡ºåŠ›ã®åˆ†å²ã‚’æ›¸ã
  - slf4jãªã©ã®å ´åˆã€ `if (logger.isDebugEnabled()) {...}` ãªã©ã¨ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ã¦åˆ†å²ã•ã›ã‚‹ã€‚ç‰¹ã«ãƒ­ã‚°å‡ºåŠ›ç”¨ã«æ–‡å­—åˆ—åŠ å·¥ã™ã‚‹å ´åˆã¯å¿…é ˆã¨ã™ã‚‹
  - Goã®ãƒ­ã‚®ãƒ³ã‚°ã¯ä¸Šè¨˜ã®ã‚ˆã†ãªæ…£ç¿’ãŒç„¡ã„ãŸã‚è¡Œã‚ãªãã¦ã‚‚è‰¯ã„ï¼ˆæ§‹é€ åŒ–ãƒ­ã‚®ãƒ³ã‚°ã®å ´åˆã€æ–‡å­—åˆ—ã‚’ç”Ÿæˆã—ãªã„ãŸã‚è¨±å®¹ã•ã‚Œã¦ã„ã‚‹ã¨æ€ã‚ã‚Œã‚‹ï¼‰

æ³¨æ„ç‚¹ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

- forãƒ«ãƒ¼ãƒ—ã§ã®ãƒã‚·ãƒ³ã‚¬ãƒ³ãƒ­ã‚°ã¯NG
  - 1000ä»¶ã«1åº¦ãªã©ã€ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ãŸãƒ­ã‚°å‡ºåŠ›ã‚’è¡Œã†
- ãƒ•ã‚¡ã‚¤ãƒ«åãƒ»è¡Œç•ªå·ã¯ãƒ­ã‚°å‡ºåŠ›é …ç›®ã«ã—ãªã„
  - ãƒ­ã‚°é …ç›®ã¨ã—ã¦ã€Œãƒ•ã‚¡ã‚¤ãƒ«åã€ã‚„ã€Œè¡Œç•ªå·ã€ã‚’å–å¾—ã™ã‚‹å‡¦ç†ã¯ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ã™ã‚‹å ´åˆã¯è² è·ãŒé«˜ãã€æ€§èƒ½åŠ£åŒ–ã®åŸå› ã«ãªã‚Šãˆã‚‹
  - ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®ã¿è¨±å®¹ã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆç’°å¢ƒã«ã¯å‡ºåŠ›ã•ã›ãªã„ã€‚Javaã§ã‚ã‚Œã°ãƒ­ã‚¬ãƒ¼åã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«åã®ç‰¹å®šã¯å®¹æ˜“ã§ã‚ã‚‹ãŸã‚
- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã§ã®æ€§èƒ½å•é¡Œã®ç–‘ã„ãŒã‚ã‚‹å ´åˆã€ãƒ­ã‚°å‡ºåŠ›ã‚’ç–‘ã£ã¦ã¿ã‚‹
  - ç‰¹ã«SQLãƒ­ã‚°ãªã©ã‚’å¤§é‡ã«å‡ºåŠ›ã—ã¦ã„ã‚‹å ´åˆã€ãã“ãŒé…ã„å ´åˆã‚‚ã‚ã‚‹

::: tip logback.xml ã®è¨­å®šä¾‹  
AsyncAppenderã®è¨­å®šä¾‹ã‚’ç¤ºã™ã€‚

```xml
<configuration>
  <appender name="JSON_STDOUT" class="ch.qos.logback.core.ConsoleAppender">
    <encoder class="net.logstash.logback.encoder.LogstashEncoder" />
  </appender>
  <appender name="ASYNC_JSON_STDOUT" class="ch.qos.logback.classic.AsyncAppender">
    <discardingThreshold>0</discardingThreshold>
    <queueSize>256</queueSize>
    <appender-ref ref="JSON_STDOUT" />
  </appender>
  <root level="INFO">
    <appender-ref ref="ASYNC_JSON_STDOUT" />
  </root>
</configuration>
```

:::

::: tip ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°ã«æ³¨æ„  
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ­ã‚»ã‚¹ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã‚ˆã†ãªè‡´å‘½çš„ãªã‚¨ãƒ©ãƒ¼ï¼ˆFATALãƒ¬ãƒ™ãƒ«ãªã©ï¼‰ãŒç™ºç”Ÿã—ãŸå ´åˆã€æœ€å¾Œã«è¨˜éŒ²ã—ã‚ˆã†ã¨ã—ãŸãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå¤±ã‚ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚ã“ã‚Œã¯æ€§èƒ½å‘ä¸Šã®ãŸã‚ã«ãƒ­ã‚°å‡ºåŠ›å†…å®¹ã‚’ãƒ¡ãƒ¢ãƒªä¸Šã«ãƒãƒƒãƒ•ã‚¡ã™ã‚‹ã“ã¨ã§ç”Ÿã˜ã‚‹ã€‚ã“ã‚Œã¯åŸå› ç‰¹å®šã®æ‰‹ãŒã‹ã‚ŠãŒæ¬ æã™ã‚‹ãŸã‚ã€ã‚ˆãå•é¡Œã«ãªã‚‹ã€‚

ã“ã®å•é¡Œã‚’å›é¿ã™ã‚‹ãŸã‚ã€ã€Œã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã¯å³åº§ã«æ›¸ãå‡ºã™ï¼ˆãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ï¼‰ã¹ãã€ã¨ã„ã†è€ƒãˆæ–¹ãŒæ˜”ã‹ã‚‰èªã‚‰ã‚Œã¦ããŸã€‚å…·ä½“çš„ã«ã¯ã€æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ï¼ˆstderrï¼‰ã¯ã€æ¨™æº–å‡ºåŠ›ï¼ˆstdoutï¼‰ã¨ç•°ãªã‚Šã€å¤šãã®ç’°å¢ƒã§è¡Œãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°ï¼ˆæ”¹è¡Œã”ã¨ã«æ›¸ãå‡ºã—ï¼‰ã‚„ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°ãªã—ã§å‹•ä½œã™ã‚‹ãŸã‚ã€ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®å‡ºåŠ›å…ˆã¨ã—ã¦æ¨å¥¨ã•ã‚Œã¦ããŸçµŒç·¯ãŒã‚ã‚‹ã€‚Goã®slogã§ã¯æ˜ç¤ºçš„ã«bufio.Writerãªã©ã‚’åˆ©ç”¨ã—ãªã„é™ã‚Šã¯ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°ã—ãªã„ãŒã€ãã†ã§ã¯ãªã„è¨€èªã§ã¯æ³¨æ„ãŒå¿…è¦ã§ã‚ã‚‹ã€‚

Javaã®ãƒ­ã‚®ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆLogback, Log4j2ãªã©ï¼‰ã§ã¯ã€ç‰¹å®šã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ï¼ˆä¾‹: WARNä»¥ä¸Šï¼‰ã®ãƒ­ã‚°ãŒè¨˜éŒ²ã•ã‚ŒãŸéš›ã«ã€è‡ªå‹•çš„ã«ãƒãƒƒãƒ•ã‚¡ã‚’ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹è¨­å®šãŒå¯èƒ½ã§ã‚ã‚‹ãŸã‚ã€è¨­å®šã‚’ç¢ºèªã™ã‚‹ã¨è‰¯ã„ã€‚

è¨­å®šä¾‹ (Logback)

```xml
<appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
        <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
    </encoder>
    <immediateFlush>true</immediateFlush>
</appender>
```

â€»æ³¨: ConsoleAppenderã®immediateFlushã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§trueã§ã‚ã‚‹ã€‚ã“ã“ã§ã¯èª¬æ˜ã®ãŸã‚ã«ã‚ãˆã¦æ˜ç¤ºçš„ã«è¨˜è¼‰ã—ã¦ã„ã‚‹  
:::

# è²»ç”¨

CloudWatch Logsã‚„ãã®ä»–ã®ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ­ã‚°ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆDatadogãªã©ï¼‰ã¯ã€ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿é‡ï¼ˆGBï¼‰ã«å¿œã˜ãŸèª²é‡‘ã§ã‚ã‚Šã€ä¿æŒæœŸé–“ã«å¿œã˜ãŸã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸è²»ç”¨ã‚‚å¿…è¦ã¨ãªã‚‹ã€‚ãƒ­ã‚°æ¤œç´¢æ™‚ã¯ã€ã‚¯ã‚¨ãƒªã®ã‚¹ã‚­ãƒ£ãƒ³ã«å¿œã˜ã¦èª²é‡‘ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãŒå¤šã„ã€‚

- æ¨å¥¨
  - ç™ºç”Ÿæºã§ãƒ­ã‚°ãŒã§ãã‚‹é™ã‚Šçµã‚‹
    - ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã¯é©åˆ‡ã«è¨­å®šã—ã€ç”¨é€”ãŒä¸æ˜ãªãƒ­ã‚°ã¯å‡ºåŠ›ã—ãªã„
    - å·¨å¤§ãªãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¯ãƒ­ã‚°å‡ºåŠ›ã—ãªã„ï¼ˆä¾‹ãˆã°ã€Base64åŒ–ã—ãŸãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ãªã©ï¼‰
    - ãƒ­ã‚°ã‚’å‰Šã‚‹ã“ã¨ãŒç›®çš„ã§ã¯ãªãã€ç„¡é§„ãªãƒ­ã‚°ã‚’å‰Šã‚‹ã€‚éšœå®³ç™ºç”Ÿæ™‚ã€èª¿æŸ»ã«å¿…è¦ãªãƒ­ã‚°ãŒæ¬ è½ã—ã¦ã—ã¾ãˆã°æœ¬æœ«è»¢å€’ã§ã‚ã‚‹ãŸã‚
  - æœ€åˆã‹ã‚‰æ§‹é€ åŒ–ãƒ­ã‚®ãƒ³ã‚°ã«ã™ã‚‹
    - ãƒ­ã‚°åŸºç›¤å´ã§ã®ãƒ‘ãƒ¼ã‚¹å‡¦ç†ã¯é«˜ã‚³ã‚¹ãƒˆã§ã‚ã‚‹ãŸã‚ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸Šã‹ã‚‰JSONLinesã§å‡ºåŠ›ã™ã‚‹
  - ä¿æŒæœŸé–“ãƒãƒªã‚·ãƒ¼ã‚’æ˜ç¢ºã«ã™ã‚‹
    - ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã‚„ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹è¦ä»¶ã«åŸºã¥ãã€ä¿æŒæœŸé–“ã‚’å®šã‚ã‚‹ï¼ˆä¾‹: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°ã¯30æ—¥ãªã©ï¼‰
    - ç’°å¢ƒåˆ¥ã«å®šç¾©ã™ã‚‹ã€‚ä¾‹ãˆã°ã€é–‹ç™ºç’°å¢ƒã¯1é€±é–“ãªã©ã€çŸ­ãã™ã‚‹ã“ã¨ã‚‚æœ‰åŠ¹
  - ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸éšå±¤åŒ–
    - ãƒ‡ãƒ¼ã‚¿ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†æ©Ÿèƒ½ã¯åŸå‰‡ä¸è¦ã¨ã™ã‚‹
    - ä¾‹: AWSã§ã¯ä¸€å®šæœŸé–“ï¼ˆä¾‹: 14æ—¥ï¼‰ã‚’éããŸãƒ­ã‚°ã¯ã€å®‰ä¾¡ãªã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆAmazon S3 Glacierãªã©ï¼‰ã¸è‡ªå‹•çš„ã«ç§»å‹•ã•ã›ã‚‹ãªã©ã‚‚å¯èƒ½ã ãŒã€ã‚³ã‚¹ãƒˆãƒ¡ãƒªãƒƒãƒˆãŒãã“ã¾ã§å¤§ãããªã„

::: info å‚è€ƒ

- [CloudWatch Logs ã¨ S3 ã«ã‹ã‹ã‚‹æ–™é‡‘æ¯”è¼ƒ | DevelopersIO](https://dev.classmethod.jp/articles/comparison-of-fees-for-cloudwatch-logs-and-s3/)
  - CloudWatch Logs \-\> S3 ã«ç§»å‹•ã•ã›ã¦ã‚‚ã€ãã“ã¾ã§å¤§ããªã‚³ã‚¹ãƒˆåœ§ç¸®ã«ã¯ãªã‚‰ãªã„ã¨è€ƒãˆã‚‰ã‚Œã‚‹
- [Amazon CloudWatch Logs ã® Amazon S3 ã¸ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ–¹å¼ã®æ¤œè¨ â€“ TechHarmony](https://blog.usize-tech.com/export-cloudwatch-logs-to-s3/)
  - S3ã¸ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¨­å®šã‚‚ã„ãã¤ã‹ã®è¨­è¨ˆãŒå¿…è¦ã§ã‚ã‚‹

:::

# è¬è¾

ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã®ä½œæˆã«ã¯å¤šãã®æ–¹ã€…ã«ã”å”åŠ›ã„ãŸã ã„ãŸã€‚å¿ƒã‚ˆã‚Šæ„Ÿè¬ç”³ã—ä¸Šã’ã‚‹ã€‚

- **ä½œæˆè€…**: çœŸé‡éš¼è¨˜ã€å…«æœ¨é›…æ–—ã€å®®å´å°†å¤ªã€æ­¦ç”°å¤§è¼ã€æ¾å·å–œè¦
- **ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼**: å‹Ÿé›†ä¸­
